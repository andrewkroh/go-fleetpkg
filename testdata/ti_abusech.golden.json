{
  "build": {
    "dependencies": {
      "ecs": {
        "reference": "git@v8.11.0"
      }
    }
  },
  "manifest": {
    "name": "ti_abusech",
    "title": "AbuseCH",
    "version": "3.0.0",
    "description": "Ingest threat intelligence indicators from URL Haus, Malware Bazaar, and Threat Fox feeds with Elastic Agent.",
    "type": "integration",
    "icons": [
      {
        "src": "/img/abusech2.svg",
        "title": "AbuseCH",
        "size": "512x512",
        "type": "image/svg+xml"
      }
    ],
    "format_version": "3.3.2",
    "categories": [
      "security",
      "threat_intel"
    ],
    "conditions": {
      "elastic": {},
      "kibana": {
        "version": "^8.18.0 || ^9.0.0"
      }
    },
    "screenshots": [
      {
        "src": "/img/abusech-overview.png",
        "title": "AbuseCH Overview Dashboard Screenshot",
        "size": "600x600",
        "type": "image/png"
      },
      {
        "src": "/img/abusech-files.png",
        "title": "AbuseCH Files Dashboard Screenshot",
        "size": "600x600",
        "type": "image/png"
      },
      {
        "src": "/img/abusech-urls.png",
        "title": "AbuseCH URLs Dashboard Screenshot",
        "size": "600x600",
        "type": "image/png"
      }
    ],
    "source": {},
    "policy_templates": [
      {
        "name": "ti_abusech",
        "title": "AbuseCH API",
        "description": "Ingest threat intelligence indicators from URL Haus, Malware Bazaar, and Threat Fox feeds with Elastic Agent.",
        "inputs": [
          {
            "type": "cel",
            "title": "Collect AbuseCH logs via API using Elastic Agent",
            "description": "Ingest threat intelligence indicators from URL Haus, Malware Bazaar, and Threat Fox feeds with Elastic Agent.",
            "vars": [
              {
                "name": "auth_key",
                "description": "AbuseCH API key. This is required for authentication for all API requests. See [documentation](https://abuse.ch/blog/community-first/) for details.",
                "type": "password",
                "title": "Auth Key",
                "multi": false,
                "required": true,
                "secret": true,
                "show_user": true
              },
              {
                "name": "enable_request_tracer",
                "default": false,
                "description": "The request tracer logs requests and responses to the agent's local file-system for debugging configurations. Enabling this request tracing compromises security and should only be used for debugging. Disabling the request tracer will delete any stored traces. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-input-cel.html#_resource_tracer_enable) for details.",
                "type": "bool",
                "title": "Enable request tracing",
                "multi": false,
                "required": false,
                "show_user": false
              }
            ]
          }
        ],
        "deployment_modes": {
          "default": {
            "enabled": true
          },
          "agentless": {
            "enabled": true,
            "organization": "security",
            "division": "engineering",
            "team": "security-service-integrations",
            "resources": {
              "requests": {
                "memory": "2Gi"
              }
            }
          }
        }
      }
    ],
    "owner": {
      "github": "elastic/security-service-integrations",
      "type": "elastic"
    }
  },
  "data_streams": {
    "malware": {
      "manifest": {
        "ilm_policy": "logs-ti_abusech.malware-default_policy",
        "title": "AbuseCH Malware payloads",
        "type": "logs",
        "streams": [
          {
            "input": "cel",
            "description": "Collect AbuseCH Malware payloads using Elastic Agent",
            "title": "AbuseCH Malware payloads using Elastic Agent",
            "template_path": "cel.yml.hbs",
            "vars": [
              {
                "name": "url",
                "default": "https://urlhaus-api.abuse.ch/v1/payloads/recent/",
                "type": "text",
                "title": "AbuseCH Malware API endpoint",
                "multi": false,
                "required": true,
                "show_user": false
              },
              {
                "name": "http_client_timeout",
                "default": "30s",
                "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.",
                "type": "text",
                "title": "HTTP Client Timeout",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "proxy_url",
                "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
                "type": "text",
                "title": "Proxy URL",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "interval",
                "default": "10m",
                "description": "Interval at which the malware payloads will be pulled. Supported units for this parameter are h/m/s.",
                "type": "text",
                "title": "Interval",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ioc_expiration_duration",
                "default": "90d",
                "description": "Indicator is expired after this duration since its last seen timestamp. Use [Elasticsearch time units](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units) in days, hours, or minutes (e.g 10d). Default `90d`.",
                "type": "text",
                "title": "IOC Expiration Duration",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ssl",
                "description": "SSL configuration options. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config) for details.",
                "type": "yaml",
                "title": "SSL Configuration",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "tags",
                "default": [
                  "forwarded",
                  "abusech-malware"
                ],
                "type": "text",
                "title": "Tags",
                "multi": true,
                "required": true,
                "show_user": false
              },
              {
                "name": "preserve_original_event",
                "default": false,
                "description": "Preserves a raw copy of the original event, added to the field `event.original`",
                "type": "bool",
                "title": "Preserve original event",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "processors",
                "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
                "type": "yaml",
                "title": "Processors",
                "multi": false,
                "required": false,
                "show_user": false
              }
            ],
            "enabled": true
          }
        ]
      },
      "pipelines": {
        "default.yml": {
          "description": "Pipeline for parsing Abuse.ch URL Threat Intel",
          "processors": [
            {
              "remove": {
                "description": "Removes the fields added by Agentless as metadata, as they can collide with ECS fields.",
                "field": [
                  "organization",
                  "division",
                  "team"
                ],
                "if": "ctx.organization instanceof String \u0026\u0026 ctx.division instanceof String \u0026\u0026 ctx.team instanceof String",
                "ignore_missing": true,
                "tag": "remove_agentless_tags"
              }
            },
            {
              "set": {
                "field": "ecs.version",
                "value": "8.11.0"
              }
            },
            {
              "set": {
                "field": "event.kind",
                "value": "enrichment"
              }
            },
            {
              "set": {
                "field": "event.category",
                "value": [
                  "threat"
                ]
              }
            },
            {
              "set": {
                "field": "event.type",
                "value": [
                  "indicator"
                ]
              }
            },
            {
              "rename": {
                "field": "message",
                "if": "ctx.event?.original == null",
                "ignore_missing": true,
                "target_field": "event.original"
              }
            },
            {
              "remove": {
                "description": "The `message` field is no longer required if the document has an `event.original` field.",
                "field": "message",
                "if": "ctx.event?.original != null",
                "ignore_missing": true
              }
            },
            {
              "json": {
                "field": "event.original",
                "target_field": "abusech.malware"
              }
            },
            {
              "date": {
                "field": "abusech.malware.firstseen",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z",
                  "yyyy-MM-dd HH:mm:ss"
                ],
                "if": "ctx.abusech?.malware?.firstseen != null",
                "target_field": "threat.indicator.first_seen"
              }
            },
            {
              "set": {
                "copy_from": "abusech.malware.sha256_hash",
                "field": "threat.indicator.name",
                "if": "ctx.abusech?.malware?.sha256_hash != null",
                "tag": "set-indicator-name"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "value": "file"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.file_size",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.size"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.file_type",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.type"
              }
            },
            {
              "remove": {
                "field": "abusech.malware.urlhaus_download",
                "ignore_missing": true
              }
            },
            {
              "convert": {
                "field": "threat.indicator.file.size",
                "ignore_missing": true,
                "type": "long"
              }
            },
            {
              "convert": {
                "field": "abusech.malware.virustotal.percent",
                "ignore_missing": true,
                "type": "float"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.md5_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.md5"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.sha256_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.sha256"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.imphash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.pe.imphash"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.ssdeep",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.ssdeep"
              }
            },
            {
              "rename": {
                "field": "abusech.malware.tlsh",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.tlsh"
              }
            },
            {
              "append": {
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.hash?.md5 != null",
                "value": "{{{threat.indicator.file.hash.md5}}}"
              }
            },
            {
              "append": {
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.hash?.sha256 != null",
                "value": "{{{threat.indicator.file.hash.sha256}}}"
              }
            },
            {
              "append": {
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.hash?.ssdeep != null",
                "value": "{{{threat.indicator.file.hash.ssdeep}}}"
              }
            },
            {
              "append": {
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.pe?.imphash != null",
                "value": "{{{threat.indicator.file.pe.imphash}}}"
              }
            },
            {
              "append": {
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.hash?.tlsh != null",
                "value": "{{{threat.indicator.file.hash.tlsh}}}"
              }
            },
            {
              "foreach": {
                "field": "abusech.malware.tags",
                "if": "ctx.abusech?.malware?.tags instanceof List",
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "tags",
                    "value": "{{{_ingest._value}}}"
                  }
                }
              }
            },
            {
              "remove": {
                "field": "abusech.malware.tags",
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Indicator Expiration is done after `_conf.ioc_expiration_duration` (default 90d) since the indicator's last_seen time (if not present, then since first_seen). This script adds a default `abusech.malware.deleted_at` field to allow indicator expiration.",
                "if": "ctx.abusech?.malware?.deleted_at == null \u0026\u0026 ctx._conf?.ioc_expiration_duration != null \u0026\u0026 (ctx._conf.ioc_expiration_duration instanceof String) \u0026\u0026 ctx._conf.ioc_expiration_duration != ''",
                "lang": "painless",
                "source": "def dur = ctx._conf.ioc_expiration_duration; ZonedDateTime _tmp_deleted_at; ZonedDateTime _tmp_updated_at; if (ctx.threat.indicator.last_seen != null) {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.last_seen);\n} else {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.first_seen);\n} String time_unit = dur.substring(dur.length() -  1, dur.length()); String time_value = dur.substring(0, dur.length() - 1); if (time_unit == 'd') {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(Long.parseLong(time_value));\n} else if (time_unit == 'h') {\n  _tmp_deleted_at = _tmp_updated_at.plusHours(Long.parseLong(time_value));\n} else if (time_unit == 'm') {\n  _tmp_deleted_at = _tmp_updated_at.plusMinutes(Long.parseLong(time_value));\n} else {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(90L);\n  if (ctx.error == null) {\n    ctx.error = new HashMap();\n  }\n  if (ctx.error.message == null) {\n    ctx.error.message = new ArrayList();\n  }\n  ctx.error.message.add('invalid ioc_expiration_duration: using default 90 days');\n} ctx.abusech.malware.deleted_at = _tmp_deleted_at;\n",
                "tag": "script-default-deleted_at"
              }
            },
            {
              "date": {
                "field": "abusech.malware.deleted_at",
                "formats": [
                  "ISO8601",
                  "UNIX"
                ],
                "tag": "date_deleted_at",
                "target_field": "abusech.malware.deleted_at"
              }
            },
            {
              "rename": {
                "field": "_conf.ioc_expiration_duration",
                "ignore_missing": true,
                "tag": "rename_conf_ioc_expiration_duration",
                "target_field": "abusech.malware.ioc_expiration_duration"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx?.threat?.indicator?.type == null",
                "value": "unknown"
              }
            },
            {
              "script": {
                "if": "ctx?.abusech != null",
                "lang": "painless",
                "source": "void handleMap(Map map) {\n  for (def x : map.values()) {\n    if (x instanceof Map) {\n        handleMap(x);\n    } else if (x instanceof List) {\n        handleList(x);\n    }\n  }\nmap.values().removeIf(v -\u003e v == null);\n}\nvoid handleList(List list) {\n  for (def x : list) {\n      if (x instanceof Map) {\n          handleMap(x);\n      } else if (x instanceof List) {\n          handleList(x);\n      }\n  }\n}\nhandleMap(ctx);\n"
              }
            },
            {
              "remove": {
                "field": [
                  "abusech.malware.firstseen",
                  "message",
                  "_conf"
                ],
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Remove null/empty values recursively.",
                "lang": "painless",
                "source": "boolean drop(Object o) {\n  if (o == null || o == '') {\n    return true;\n  } else if (o instanceof Map) {\n    ((Map) o).values().removeIf(v -\u003e drop(v));\n    return (((Map) o).size() == 0);\n  } else if (o instanceof List) {\n    ((List) o).removeIf(v -\u003e drop(v));\n    return (((List) o).length == 0);\n  }\n  return false;\n}\ndrop(ctx);"
              }
            }
          ],
          "on_failure": [
            {
              "set": {
                "field": "event.kind",
                "value": "pipeline_error"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "tags",
                "value": "preserve_original_event"
              }
            },
            {
              "append": {
                "field": "error.message",
                "value": "Processor {{{ _ingest.on_failure_processor_type }}} {{{#_ingest.on_failure_processor_tag}}}with tag {{{ _ingest.on_failure_processor_tag }}} {{{/_ingest.on_failure_processor_tag}}}in pipeline {{{_ingest.pipeline}}} failed with message {{{ _ingest.on_failure_message }}}"
              }
            }
          ]
        }
      },
      "sample_event": {
        "event": {
          "@timestamp": "2024-04-17T15:13:48.417Z",
          "abusech": {
            "malware": {
              "deleted_at": "2021-10-10T04:17:02.000Z",
              "ioc_expiration_duration": "5d"
            }
          },
          "agent": {
            "ephemeral_id": "1bd72be7-3c0a-4954-b125-1543feab3c21",
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "name": "docker-fleet-agent",
            "type": "filebeat",
            "version": "8.12.1"
          },
          "data_stream": {
            "dataset": "ti_abusech.malware",
            "namespace": "ep",
            "type": "logs"
          },
          "ecs": {
            "version": "8.11.0"
          },
          "elastic_agent": {
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "snapshot": false,
            "version": "8.12.1"
          },
          "event": {
            "agent_id_status": "verified",
            "category": [
              "threat"
            ],
            "dataset": "ti_abusech.malware",
            "ingested": "2024-04-17T15:14:00Z",
            "kind": "enrichment",
            "original": "{\"file_size\":\"1563\",\"file_type\":\"unknown\",\"firstseen\":\"2021-10-05 04:17:02\",\"imphash\":null,\"md5_hash\":\"9cd5a4f0231a47823c4adba7c8ef370f\",\"sha256_hash\":\"7c0852d514df7faf8fdbfa4f358cc235dd1b1a2d843cc65495d03b502e4099f2\",\"signature\":null,\"ssdeep\":\"48:yazkS7neW+mfe4CJjNXcq5Co4Fr1PpsHn:yrmGNt5mbP2n\",\"tlsh\":\"T109314C5E7822CA70B91AD69300C22D8C2F53EAF229E6686C3BDD4C86FA1344208CF1\",\"urlhaus_download\":\"https://urlhaus-api.abuse.ch/v1/download/7c0852d514df7faf8fdbfa4f358cc235dd1b1a2d843cc65495d03b502e4099f2/\",\"virustotal\":null}",
            "type": [
              "indicator"
            ]
          },
          "input": {
            "type": "cel"
          },
          "related": {
            "hash": [
              "9cd5a4f0231a47823c4adba7c8ef370f",
              "7c0852d514df7faf8fdbfa4f358cc235dd1b1a2d843cc65495d03b502e4099f2",
              "48:yazkS7neW+mfe4CJjNXcq5Co4Fr1PpsHn:yrmGNt5mbP2n",
              "T109314C5E7822CA70B91AD69300C22D8C2F53EAF229E6686C3BDD4C86FA1344208CF1"
            ]
          },
          "tags": [
            "preserve_original_event",
            "forwarded",
            "abusech-malware"
          ],
          "threat": {
            "indicator": {
              "file": {
                "hash": {
                  "md5": "9cd5a4f0231a47823c4adba7c8ef370f",
                  "sha256": "7c0852d514df7faf8fdbfa4f358cc235dd1b1a2d843cc65495d03b502e4099f2",
                  "ssdeep": "48:yazkS7neW+mfe4CJjNXcq5Co4Fr1PpsHn:yrmGNt5mbP2n",
                  "tlsh": "T109314C5E7822CA70B91AD69300C22D8C2F53EAF229E6686C3BDD4C86FA1344208CF1"
                },
                "size": 1563,
                "type": "unknown"
              },
              "first_seen": "2021-10-05T04:17:02.000Z",
              "name": "7c0852d514df7faf8fdbfa4f358cc235dd1b1a2d843cc65495d03b502e4099f2",
              "type": "file"
            }
          }
        }
      },
      "fields": {
        "agent.yml": {
          "fields": [
            {
              "name": "cloud",
              "type": "group",
              "description": "Fields related to the cloud or infrastructure the events are coming from.",
              "fields": [
                {
                  "name": "image.id",
                  "type": "keyword",
                  "description": "Image ID for the cloud instance."
                }
              ],
              "_additional_attributes": {
                "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
                "group": 2,
                "title": "Cloud"
              }
            },
            {
              "name": "host",
              "type": "group",
              "description": "A host is defined as a general computing instance.  ECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
              "fields": [
                {
                  "name": "containerized",
                  "type": "boolean",
                  "description": "If the host is a container.\n"
                },
                {
                  "name": "os.build",
                  "type": "keyword",
                  "description": "OS build information.\n",
                  "example": "18D109"
                },
                {
                  "name": "os.codename",
                  "type": "keyword",
                  "description": "OS codename, if any.\n",
                  "example": "stretch"
                }
              ],
              "_additional_attributes": {
                "group": 2,
                "title": "Host"
              }
            }
          ]
        },
        "base-fields.yml": {
          "fields": [
            {
              "name": "data_stream.type",
              "type": "constant_keyword",
              "description": "Data stream type."
            },
            {
              "name": "data_stream.dataset",
              "type": "constant_keyword",
              "description": "Data stream dataset name."
            },
            {
              "name": "data_stream.namespace",
              "type": "constant_keyword",
              "description": "Data stream namespace."
            },
            {
              "name": "event.module",
              "type": "constant_keyword",
              "description": "Event module",
              "value": "ti_abusech"
            },
            {
              "name": "event.dataset",
              "type": "constant_keyword",
              "description": "Event dataset",
              "value": "ti_abusech.malware"
            },
            {
              "name": "threat.feed.name",
              "type": "constant_keyword",
              "description": "Display friendly feed name",
              "value": "AbuseCH Malware"
            },
            {
              "name": "threat.feed.dashboard_id",
              "type": "constant_keyword",
              "description": "Dashboard ID used for Kibana CTI UI",
              "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
            },
            {
              "name": "@timestamp",
              "type": "date",
              "description": "Event timestamp."
            }
          ]
        },
        "beats.yml": {
          "fields": [
            {
              "name": "input.type",
              "type": "keyword",
              "description": "Type of Filebeat input."
            },
            {
              "name": "log.flags",
              "type": "keyword",
              "description": "Flags for the log file."
            },
            {
              "name": "log.offset",
              "type": "long",
              "description": "Offset of the entry in the log file."
            }
          ]
        },
        "ecs.yml": {
          "fields": [
            {
              "name": "threat.indicator.first_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.last_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.modified_at",
              "external": "ecs"
            }
          ]
        },
        "fields.yml": {
          "fields": [
            {
              "name": "abusech.malware",
              "type": "group",
              "description": "All fields related to AbuseCH URL indicators.",
              "fields": [
                {
                  "name": "signature",
                  "type": "keyword",
                  "description": "Malware family.\n"
                },
                {
                  "name": "virustotal.result",
                  "type": "keyword",
                  "description": "AV detection ratio.\n"
                },
                {
                  "name": "virustotal.percent",
                  "type": "float",
                  "description": "AV detection in percent.\n"
                },
                {
                  "name": "virustotal.link",
                  "type": "keyword",
                  "description": "Link to the Virustotal report.\n"
                },
                {
                  "name": "deleted_at",
                  "type": "date",
                  "description": "The indicator expiration timestamp.\n"
                },
                {
                  "name": "ioc_expiration_duration",
                  "type": "keyword",
                  "description": "The configured expiration duration.\n"
                }
              ]
            }
          ]
        },
        "is-ioc-transform-source-true.yml": {
          "fields": [
            {
              "name": "labels.is_ioc_transform_source",
              "type": "constant_keyword",
              "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
              "value": "true"
            }
          ]
        }
      }
    },
    "malwarebazaar": {
      "manifest": {
        "ilm_policy": "logs-ti_abusech.malwarebazaar-default_policy",
        "title": "AbuseCH MalwareBazaar payloads",
        "type": "logs",
        "streams": [
          {
            "input": "cel",
            "description": "Collect AbuseCH MalwareBazaar payloads using Elastic Agent",
            "title": "AbuseCH MalwareBazaar payloads using Elastic Agent",
            "template_path": "cel.yml.hbs",
            "vars": [
              {
                "name": "url",
                "default": "https://mb-api.abuse.ch/api/v1/",
                "type": "text",
                "title": "AbuseCH MalwareBazaar API endpoint",
                "multi": false,
                "required": true,
                "show_user": false
              },
              {
                "name": "http_client_timeout",
                "default": "30s",
                "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.",
                "type": "text",
                "title": "HTTP Client Timeout",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "proxy_url",
                "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
                "type": "text",
                "title": "Proxy URL",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "interval",
                "default": "10m",
                "description": "Interval at which the payloads from MalwareBazaar will be pulled. Supported units for this parameter are h/m/s.",
                "type": "text",
                "title": "Interval",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ioc_expiration_duration",
                "default": "90d",
                "description": "Indicator is expired after this duration since its last seen timestamp. Use [Elasticsearch time units](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units) in days, hours, or minutes (e.g 10d). Default `90d`.",
                "type": "text",
                "title": "IOC Expiration Duration",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ssl",
                "description": "SSL configuration options. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config) for details.",
                "type": "yaml",
                "title": "SSL Configuration",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "tags",
                "default": [
                  "forwarded",
                  "abusech-malwarebazaar"
                ],
                "type": "text",
                "title": "Tags",
                "multi": true,
                "required": true,
                "show_user": false
              },
              {
                "name": "preserve_original_event",
                "default": false,
                "description": "Preserves a raw copy of the original event, added to the field `event.original`",
                "type": "bool",
                "title": "Preserve original event",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "processors",
                "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
                "type": "yaml",
                "title": "Processors",
                "multi": false,
                "required": false,
                "show_user": false
              }
            ],
            "enabled": true
          }
        ]
      },
      "pipelines": {
        "default.yml": {
          "description": "Pipeline for parsing Abuse.ch URL Threat Intel",
          "processors": [
            {
              "remove": {
                "description": "Removes the fields added by Agentless as metadata, as they can collide with ECS fields.",
                "field": [
                  "organization",
                  "division",
                  "team"
                ],
                "if": "ctx.organization instanceof String \u0026\u0026 ctx.division instanceof String \u0026\u0026 ctx.team instanceof String",
                "ignore_missing": true,
                "tag": "remove_agentless_tags"
              }
            },
            {
              "set": {
                "field": "ecs.version",
                "value": "8.11.0"
              }
            },
            {
              "set": {
                "field": "event.kind",
                "value": "enrichment"
              }
            },
            {
              "set": {
                "field": "event.category",
                "value": [
                  "threat"
                ]
              }
            },
            {
              "set": {
                "field": "event.type",
                "value": [
                  "indicator"
                ]
              }
            },
            {
              "rename": {
                "field": "message",
                "if": "ctx.event?.original == null",
                "ignore_missing": true,
                "target_field": "event.original"
              }
            },
            {
              "remove": {
                "description": "The `message` field is no longer required if the document has an `event.original` field.",
                "field": "message",
                "if": "ctx.event?.original != null",
                "ignore_missing": true
              }
            },
            {
              "json": {
                "field": "event.original",
                "target_field": "abusech.malwarebazaar"
              }
            },
            {
              "set": {
                "copy_from": "abusech.malwarebazaar.sha256_hash",
                "field": "threat.indicator.name",
                "tag": "set-indicator-name"
              }
            },
            {
              "date": {
                "field": "abusech.malwarebazaar.first_seen",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z",
                  "yyyy-MM-dd HH:mm:ss"
                ],
                "if": "ctx.abusech?.malwarebazaar?.first_seen != null",
                "target_field": "threat.indicator.first_seen"
              }
            },
            {
              "date": {
                "field": "abusech.malwarebazaar.last_seen",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z",
                  "yyyy-MM-dd HH:mm:ss"
                ],
                "if": "ctx.abusech?.malwarebazaar?.last_seen != null",
                "target_field": "threat.indicator.last_seen"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "value": "file"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.file_name",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.name"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.file_type_mime",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.mime_type"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.reporter",
                "ignore_missing": true,
                "target_field": "threat.indicator.provider"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.origin_country",
                "ignore_missing": true,
                "target_field": "threat.indicator.geo.country_iso_code"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.signature",
                "ignore_missing": true,
                "target_field": "threat.software.alias"
              }
            },
            {
              "set": {
                "field": "threat.software.alias",
                "if": "ctx.threat?.software?.alias instanceof String",
                "value": [
                  "{{{threat.software.alias}}}"
                ]
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.file_size",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.size"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.file_type",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.extension"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.md5_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.md5"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.sha256_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.sha256"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.sha1_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.sha1"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.sha3_384_hash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.sha384"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.imphash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.pe.imphash"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.ssdeep",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.ssdeep"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.tlsh",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.hash.tlsh"
              }
            },
            {
              "rename": {
                "field": "abusech.malwarebazaar.telfhash",
                "ignore_missing": true,
                "target_field": "threat.indicator.file.elf.telfhash"
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.subject.common_name",
                    "value": "{{{_ingest._value.subject_cn}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.issuer.common_name",
                    "value": "{{{_ingest._value.issuer_cn}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.public_key_algorithm",
                    "value": "{{{_ingest._value.algorithm}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.not_before",
                    "value": "{{{_ingest._value.valid_from}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.not_after",
                    "value": "{{{_ingest._value.valid_to}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.x509.serial_number",
                    "value": "{{{_ingest._value.serial_number}}}"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "lowercase": {
                    "field": "_ingest._value.thumbprint_algorithm"
                  }
                }
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.code_sign",
                "ignore_missing": true,
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "threat.indicator.file.hash.{{{ _ingest._value.thumbprint_algorithm }}}",
                    "value": "{{{_ingest._value.thumbprint}}}"
                  }
                }
              }
            },
            {
              "script": {
                "if": "ctx.threat?.indicator?.file?.hash != null",
                "lang": "painless",
                "source": "def map = ctx.threat.indicator.file.hash;\nif(ctx.related == null) {\n    ctx.put('related', new HashMap());\n}\nif(ctx.related.hash == null) {\n    ctx.related.put('hash',new ArrayList());\n}\nfor (def x : map.values()) {\n    if (x instanceof List) {\n        for (def i : x) {\n            if(i != null \u0026\u0026 !ctx.related.hash.contains(i)) {\n                ctx.related.hash.add(i);\n            }\n        }\n    } else if(x != null \u0026\u0026 !ctx.related.hash.contains(x)) {\n        ctx.related.hash.add(x);\n    }\n}\n"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.pe?.imphash != null",
                "value": "{{{ threat.indicator.file.pe.imphash }}}"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "related.hash",
                "if": "ctx?.threat?.indicator?.file?.elf?.telfhash != null",
                "value": "{{{ threat.indicator.file.elf.telfhash }}}"
              }
            },
            {
              "convert": {
                "field": "threat.indicator.file.size",
                "ignore_missing": true,
                "type": "long"
              }
            },
            {
              "convert": {
                "field": "abusech.malwarebazaar.intelligence.downloads",
                "ignore_missing": true,
                "type": "long"
              }
            },
            {
              "convert": {
                "field": "abusech.malwarebazaar.intelligence.uploads",
                "ignore_missing": true,
                "type": "long"
              }
            },
            {
              "foreach": {
                "field": "abusech.malwarebazaar.tags",
                "if": "ctx.abusech?.malwarebazaar?.tags instanceof List",
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "tags",
                    "value": "{{{_ingest._value}}}"
                  }
                }
              }
            },
            {
              "remove": {
                "field": "abusech.malwarebazaar.tags",
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Indicator Expiration is done after `_conf.ioc_expiration_duration` (default 90d) since the indicator's last_seen time (if not present, then since first_seen). This script adds a default `abusech.threatfox.deleted_at` field to allow indicator expiration.",
                "if": "ctx.abusech?.malwarebazaar?.deleted_at == null \u0026\u0026 ctx._conf?.ioc_expiration_duration != null \u0026\u0026 (ctx._conf.ioc_expiration_duration instanceof String) \u0026\u0026 ctx._conf.ioc_expiration_duration != ''",
                "lang": "painless",
                "source": "def dur = ctx._conf.ioc_expiration_duration; ZonedDateTime _tmp_deleted_at; ZonedDateTime _tmp_updated_at; if (ctx.threat.indicator.last_seen != null) {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.last_seen);\n} else {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.first_seen);\n} String time_unit = dur.substring(dur.length() -  1, dur.length()); String time_value = dur.substring(0, dur.length() - 1); if (time_unit == 'd') {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(Long.parseLong(time_value));\n} else if (time_unit == 'h') {\n  _tmp_deleted_at = _tmp_updated_at.plusHours(Long.parseLong(time_value));\n} else if (time_unit == 'm') {\n  _tmp_deleted_at = _tmp_updated_at.plusMinutes(Long.parseLong(time_value));\n} else {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(90L);\n  if (ctx.error == null) {\n    ctx.error = new HashMap();\n  }\n  if (ctx.error.message == null) {\n    ctx.error.message = new ArrayList();\n  }\n  ctx.error.message.add('invalid ioc_expiration_duration: using default 90 days');\n} ctx.abusech.malwarebazaar.deleted_at = _tmp_deleted_at;\n",
                "tag": "script-default-deleted_at"
              }
            },
            {
              "date": {
                "field": "abusech.malwarebazaar.deleted_at",
                "formats": [
                  "ISO8601",
                  "UNIX"
                ],
                "tag": "date_deleted_at",
                "target_field": "abusech.malwarebazaar.deleted_at"
              }
            },
            {
              "rename": {
                "field": "_conf.ioc_expiration_duration",
                "ignore_missing": true,
                "tag": "rename_conf_ioc_expiration_duration",
                "target_field": "abusech.malwarebazaar.ioc_expiration_duration"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx?.threat?.indicator?.type == null",
                "value": "unknown"
              }
            },
            {
              "script": {
                "if": "ctx?.abusech != null",
                "lang": "painless",
                "source": "void handleMap(Map map) {\n  for (def x : map.values()) {\n    if (x instanceof Map) {\n        handleMap(x);\n    } else if (x instanceof List) {\n        handleList(x);\n    }\n  }\nmap.values().removeIf(v -\u003e v == null);\n}\nvoid handleList(List list) {\n  for (def x : list) {\n      if (x instanceof Map) {\n          handleMap(x);\n      } else if (x instanceof List) {\n          handleList(x);\n      }\n  }\n}\nhandleMap(ctx);\n"
              }
            },
            {
              "remove": {
                "field": [
                  "abusech.malwarebazaar.first_seen",
                  "abusech.malwarebazaar.last_seen",
                  "message",
                  "_conf"
                ],
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Remove null/empty values recursively.",
                "lang": "painless",
                "source": "boolean drop(Object o) {\n  if (o == null || o == '') {\n    return true;\n  } else if (o instanceof Map) {\n    ((Map) o).values().removeIf(v -\u003e drop(v));\n    return (((Map) o).size() == 0);\n  } else if (o instanceof List) {\n    ((List) o).removeIf(v -\u003e drop(v));\n    return (((List) o).length == 0);\n  }\n  return false;\n}\ndrop(ctx);"
              }
            }
          ],
          "on_failure": [
            {
              "set": {
                "field": "event.kind",
                "value": "pipeline_error"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "tags",
                "value": "preserve_original_event"
              }
            },
            {
              "append": {
                "field": "error.message",
                "value": "Processor {{{ _ingest.on_failure_processor_type }}} {{{#_ingest.on_failure_processor_tag}}}with tag {{{ _ingest.on_failure_processor_tag }}} {{{/_ingest.on_failure_processor_tag}}}in pipeline {{{_ingest.pipeline}}} failed with message {{{ _ingest.on_failure_message }}}"
              }
            }
          ]
        }
      },
      "sample_event": {
        "event": {
          "@timestamp": "2024-04-17T15:14:40.736Z",
          "abusech": {
            "malwarebazaar": {
              "anonymous": 0,
              "deleted_at": "2021-10-10T14:02:45.000Z",
              "intelligence": {
                "downloads": 11,
                "uploads": 1
              },
              "ioc_expiration_duration": "5d"
            }
          },
          "agent": {
            "ephemeral_id": "b4e20d95-2a07-4274-9cbb-bc9a74b68b35",
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "name": "docker-fleet-agent",
            "type": "filebeat",
            "version": "8.12.1"
          },
          "data_stream": {
            "dataset": "ti_abusech.malwarebazaar",
            "namespace": "ep",
            "type": "logs"
          },
          "ecs": {
            "version": "8.11.0"
          },
          "elastic_agent": {
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "snapshot": false,
            "version": "8.12.1"
          },
          "event": {
            "agent_id_status": "verified",
            "category": [
              "threat"
            ],
            "dataset": "ti_abusech.malwarebazaar",
            "ingested": "2024-04-17T15:14:52Z",
            "kind": "enrichment",
            "original": "{\"anonymous\":0,\"code_sign\":[],\"dhash_icon\":null,\"file_name\":\"7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e.exe\",\"file_size\":432640,\"file_type\":\"exe\",\"file_type_mime\":\"application/x-dosexec\",\"first_seen\":\"2021-10-05 14:02:45\",\"imphash\":\"f34d5f2d4577ed6d9ceec516c1f5a744\",\"intelligence\":{\"clamav\":null,\"downloads\":\"11\",\"mail\":null,\"uploads\":\"1\"},\"last_seen\":null,\"md5_hash\":\"1fc1c2997c8f55ac10496b88e23f5320\",\"origin_country\":\"FR\",\"reporter\":\"abuse_ch\",\"sha1_hash\":\"42c7153680d7402e56fe022d1024aab49a9901a0\",\"sha256_hash\":\"7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e78fd28b2253ea755c28\",\"sha3_384_hash\":\"d63e73b68973bc73ab559549aeee2141a48b8a3724aabc0d81fb14603c163a098a5a10be9f6d33b888602906c0d89955\",\"signature\":\"RedLineStealer\",\"ssdeep\":\"12288:jhhl1Eo+iEXvpb1C7drqAd1uUaJvzXGyO2F5V3bS1jsTacr:7lL\",\"tags\":[\"exe\",\"RedLineStealer\"],\"telfhash\":null,\"tlsh\":\"T13794242864BFC05994E3EEA12DDCA8FBD99A55E3640C743301B4633B8B52B84DE4F479\"}",
            "type": [
              "indicator"
            ]
          },
          "input": {
            "type": "cel"
          },
          "related": {
            "hash": [
              "42c7153680d7402e56fe022d1024aab49a9901a0",
              "d63e73b68973bc73ab559549aeee2141a48b8a3724aabc0d81fb14603c163a098a5a10be9f6d33b888602906c0d89955",
              "7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e78fd28b2253ea755c28",
              "T13794242864BFC05994E3EEA12DDCA8FBD99A55E3640C743301B4633B8B52B84DE4F479",
              "12288:jhhl1Eo+iEXvpb1C7drqAd1uUaJvzXGyO2F5V3bS1jsTacr:7lL",
              "1fc1c2997c8f55ac10496b88e23f5320",
              "f34d5f2d4577ed6d9ceec516c1f5a744"
            ]
          },
          "tags": [
            "preserve_original_event",
            "forwarded",
            "abusech-malwarebazaar",
            "exe",
            "RedLineStealer"
          ],
          "threat": {
            "indicator": {
              "file": {
                "extension": "exe",
                "hash": {
                  "md5": "1fc1c2997c8f55ac10496b88e23f5320",
                  "sha1": "42c7153680d7402e56fe022d1024aab49a9901a0",
                  "sha256": "7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e78fd28b2253ea755c28",
                  "sha384": "d63e73b68973bc73ab559549aeee2141a48b8a3724aabc0d81fb14603c163a098a5a10be9f6d33b888602906c0d89955",
                  "ssdeep": "12288:jhhl1Eo+iEXvpb1C7drqAd1uUaJvzXGyO2F5V3bS1jsTacr:7lL",
                  "tlsh": "T13794242864BFC05994E3EEA12DDCA8FBD99A55E3640C743301B4633B8B52B84DE4F479"
                },
                "mime_type": "application/x-dosexec",
                "name": "7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e.exe",
                "pe": {
                  "imphash": "f34d5f2d4577ed6d9ceec516c1f5a744"
                },
                "size": 432640
              },
              "first_seen": "2021-10-05T14:02:45.000Z",
              "geo": {
                "country_iso_code": "FR"
              },
              "name": "7a6c03013a2f2ab8b9e8e7e5d226ea89e75da72c1519e78fd28b2253ea755c28",
              "provider": "abuse_ch",
              "type": "file"
            },
            "software": {
              "alias": [
                "RedLineStealer"
              ]
            }
          }
        }
      },
      "fields": {
        "agent.yml": {
          "fields": [
            {
              "name": "cloud",
              "type": "group",
              "description": "Fields related to the cloud or infrastructure the events are coming from.",
              "fields": [
                {
                  "name": "image.id",
                  "type": "keyword",
                  "description": "Image ID for the cloud instance."
                }
              ],
              "_additional_attributes": {
                "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
                "group": 2,
                "title": "Cloud"
              }
            },
            {
              "name": "host",
              "type": "group",
              "description": "A host is defined as a general computing instance.  ECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
              "fields": [
                {
                  "name": "containerized",
                  "type": "boolean",
                  "description": "If the host is a container.\n"
                },
                {
                  "name": "os.build",
                  "type": "keyword",
                  "description": "OS build information.\n",
                  "example": "18D109"
                },
                {
                  "name": "os.codename",
                  "type": "keyword",
                  "description": "OS codename, if any.\n",
                  "example": "stretch"
                }
              ],
              "_additional_attributes": {
                "group": 2,
                "title": "Host"
              }
            }
          ]
        },
        "base-fields.yml": {
          "fields": [
            {
              "name": "data_stream.type",
              "type": "constant_keyword",
              "description": "Data stream type."
            },
            {
              "name": "data_stream.dataset",
              "type": "constant_keyword",
              "description": "Data stream dataset name."
            },
            {
              "name": "data_stream.namespace",
              "type": "constant_keyword",
              "description": "Data stream namespace."
            },
            {
              "name": "event.module",
              "type": "constant_keyword",
              "description": "Event module",
              "value": "ti_abusech"
            },
            {
              "name": "event.dataset",
              "type": "constant_keyword",
              "description": "Event dataset",
              "value": "ti_abusech.malwarebazaar"
            },
            {
              "name": "threat.feed.name",
              "type": "constant_keyword",
              "description": "Display friendly feed name",
              "value": "AbuseCH MalwareBazaar"
            },
            {
              "name": "threat.feed.dashboard_id",
              "type": "constant_keyword",
              "description": "Dashboard ID used for Kibana CTI UI",
              "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
            },
            {
              "name": "@timestamp",
              "type": "date",
              "description": "Event timestamp."
            }
          ]
        },
        "beats.yml": {
          "fields": [
            {
              "name": "input.type",
              "type": "keyword",
              "description": "Type of Filebeat input."
            },
            {
              "name": "log.flags",
              "type": "keyword",
              "description": "Flags for the log file."
            },
            {
              "name": "log.offset",
              "type": "long",
              "description": "Offset of the entry in the log file."
            }
          ]
        },
        "ecs.yml": {
          "fields": [
            {
              "name": "threat.indicator.first_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.last_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.modified_at",
              "external": "ecs"
            }
          ]
        },
        "fields.yml": {
          "fields": [
            {
              "name": "abusech.malwarebazaar",
              "type": "group",
              "description": "All fields related to AbuseCH URL indicators.",
              "fields": [
                {
                  "name": "intelligence",
                  "type": "group",
                  "fields": [
                    {
                      "name": "downloads",
                      "type": "long",
                      "description": "Number of downloads from MalwareBazaar.\n"
                    },
                    {
                      "name": "uploads",
                      "type": "long",
                      "description": "Number of uploads from MalwareBazaar.\n"
                    },
                    {
                      "name": "mail",
                      "type": "group",
                      "fields": [
                        {
                          "name": "Generic",
                          "type": "keyword",
                          "description": "Malware seen in generic spam traffic.\n"
                        },
                        {
                          "name": "IT",
                          "type": "keyword",
                          "description": "Malware seen in IT spam traffic.\n"
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "anonymous",
                  "type": "long",
                  "description": "Identifies if the sample was submitted anonymously.\n"
                },
                {
                  "name": "dhash_icon",
                  "type": "keyword",
                  "description": "In case the file is a PE executable: dhash of the samples icon.\n"
                },
                {
                  "name": "code_sign",
                  "type": "group",
                  "description": "Code signing information for the sample.\n",
                  "fields": [
                    {
                      "name": "algorithm",
                      "type": "keyword",
                      "description": "Algorithm used to generate the public key.\n"
                    },
                    {
                      "name": "cscb_listed",
                      "type": "boolean",
                      "description": "Whether the certificate is present on the Code Signing Certificate Blocklist (CSCB).\n"
                    },
                    {
                      "name": "cscb_reason",
                      "type": "keyword",
                      "description": "Why the certificate is present on the Code Signing Certificate Blocklist (CSCB).\n"
                    },
                    {
                      "name": "issuer_cn",
                      "type": "keyword",
                      "description": "Common name (CN) of issuing certificate authority.\n"
                    },
                    {
                      "name": "serial_number",
                      "type": "keyword",
                      "description": "Unique serial number issued by the certificate authority.\n"
                    },
                    {
                      "name": "subject_cn",
                      "type": "keyword",
                      "description": "Common name (CN) of subject.\n"
                    },
                    {
                      "name": "thumbprint",
                      "type": "keyword",
                      "description": "Hash of certificate.\n"
                    },
                    {
                      "name": "thumbprint_algorithm",
                      "type": "keyword",
                      "description": "Algorithm used to create thumbprint.\n"
                    },
                    {
                      "name": "valid_from",
                      "type": "date",
                      "description": "Time at which the certificate is first considered valid.\n"
                    },
                    {
                      "name": "valid_to",
                      "type": "keyword",
                      "description": "Time at which the certificate is no longer considered valid.\n"
                    }
                  ]
                },
                {
                  "name": "deleted_at",
                  "type": "date",
                  "description": "The indicator expiration timestamp.\n"
                },
                {
                  "name": "ioc_expiration_duration",
                  "type": "keyword",
                  "description": "The configured expiration duration.\n"
                }
              ]
            }
          ]
        },
        "is-ioc-transform-source-true.yml": {
          "fields": [
            {
              "name": "labels.is_ioc_transform_source",
              "type": "constant_keyword",
              "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
              "value": "true"
            }
          ]
        }
      }
    },
    "threatfox": {
      "manifest": {
        "ilm_policy": "logs-ti_abusech.threatfox-default_policy",
        "title": "AbuseCH Threat Fox indicators",
        "type": "logs",
        "streams": [
          {
            "input": "cel",
            "description": "Collect AbuseCH Threat Fox indicators using Elastic Agent",
            "title": "AbuseCH Threat Fox indicators using Elastic Agent",
            "template_path": "cel.yml.hbs",
            "vars": [
              {
                "name": "url",
                "default": "https://threatfox-api.abuse.ch/api/v1/",
                "type": "text",
                "title": "AbuseCH Threat Fox API endpoint",
                "multi": false,
                "required": true,
                "show_user": false
              },
              {
                "name": "http_client_timeout",
                "default": "30s",
                "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.",
                "type": "text",
                "title": "HTTP Client Timeout",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "proxy_url",
                "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
                "type": "text",
                "title": "Proxy URL",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "interval",
                "default": "24h",
                "description": "Interval for polling indicators from AbuseCH Threat Fox API. Supported units for this parameter are h/m/s.",
                "type": "text",
                "title": "Interval",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "initial_interval",
                "default": 7,
                "description": "How far back to look for indicators the first time the agent is started. Defaults to 7 days, can be any number between 1-7.",
                "type": "integer",
                "title": "Initial Interval",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ioc_expiration_duration",
                "default": "90d",
                "description": "Indicator is expired after this duration since its last seen timestamp. Use [Elasticsearch time units](https://www.elastic.co/guide/en/elasticsearch/reference/current/api-conventions.html#time-units) in days, hours, or minutes (e.g 10d). Default `90d`.",
                "type": "text",
                "title": "IOC Expiration Duration",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ssl",
                "description": "SSL configuration options. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config) for details.",
                "type": "yaml",
                "title": "SSL Configuration",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "tags",
                "default": [
                  "forwarded",
                  "abusech-threatfox"
                ],
                "type": "text",
                "title": "Tags",
                "multi": true,
                "required": true,
                "show_user": false
              },
              {
                "name": "preserve_original_event",
                "default": false,
                "description": "Preserves a raw copy of the original event, added to the field `event.original`",
                "type": "bool",
                "title": "Preserve original event",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "processors",
                "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
                "type": "yaml",
                "title": "Processors",
                "multi": false,
                "required": false,
                "show_user": false
              }
            ],
            "enabled": true
          }
        ]
      },
      "pipelines": {
        "default.yml": {
          "description": "Pipeline for parsing Abuse.ch Threat Fox Threat Intel",
          "processors": [
            {
              "remove": {
                "description": "Removes the fields added by Agentless as metadata, as they can collide with ECS fields.",
                "field": [
                  "organization",
                  "division",
                  "team"
                ],
                "if": "ctx.organization instanceof String \u0026\u0026 ctx.division instanceof String \u0026\u0026 ctx.team instanceof String",
                "ignore_missing": true,
                "tag": "remove_agentless_tags"
              }
            },
            {
              "set": {
                "field": "ecs.version",
                "value": "8.11.0"
              }
            },
            {
              "set": {
                "field": "event.kind",
                "value": "enrichment"
              }
            },
            {
              "set": {
                "field": "event.category",
                "value": [
                  "threat"
                ]
              }
            },
            {
              "set": {
                "field": "event.type",
                "value": [
                  "indicator"
                ]
              }
            },
            {
              "rename": {
                "field": "message",
                "if": "ctx.event?.original == null",
                "ignore_missing": true,
                "target_field": "event.original"
              }
            },
            {
              "remove": {
                "description": "The `message` field is no longer required if the document has an `event.original` field.",
                "field": "message",
                "if": "ctx.event?.original != null",
                "ignore_missing": true
              }
            },
            {
              "json": {
                "field": "event.original",
                "target_field": "abusech.threatfox"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.id",
                "ignore_missing": true,
                "target_field": "event.id"
              }
            },
            {
              "date": {
                "field": "abusech.threatfox.first_seen",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z",
                  "yyyy-MM-dd HH:mm:ss"
                ],
                "if": "ctx.abusech?.threatfox?.first_seen != null",
                "target_field": "threat.indicator.first_seen"
              }
            },
            {
              "date": {
                "field": "abusech.threatfox.last_seen",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z",
                  "yyyy-MM-dd HH:mm:ss"
                ],
                "if": "ctx.abusech?.threatfox?.last_seen != null",
                "target_field": "threat.indicator.last_seen"
              }
            },
            {
              "set": {
                "copy_from": "abusech.threatfox.ioc",
                "field": "threat.indicator.name",
                "tag": "set-indicator-name"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.ioc_type_desc",
                "ignore_missing": true,
                "target_field": "threat.indicator.description"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.reporter",
                "ignore_missing": true,
                "target_field": "threat.indicator.provider"
              }
            },
            {
              "split": {
                "field": "abusech.threatfox.malware_alias",
                "ignore_missing": true,
                "separator": ",",
                "target_field": "threat.software.alias"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.reporter",
                "ignore_missing": true,
                "target_field": "threat.indicator.provider"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.reference",
                "ignore_missing": true,
                "target_field": "threat.indicator.reference"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.malware_printable",
                "ignore_missing": true,
                "target_field": "threat.software.name"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.malware_malpedia",
                "ignore_missing": true,
                "target_field": "threat.software.reference"
              }
            },
            {
              "script": {
                "description": "Normalize confidence level.",
                "if": "ctx.abusech?.threatfox?.confidence_level != null",
                "lang": "painless",
                "source": "def value = ctx.abusech.threatfox.confidence_level; def confidence = \"None\"; if (value \u003e 0 \u0026\u0026 value \u003c 30) {\n  confidence = \"Low\";\n} if (value \u003e= 30.0 \u0026\u0026 value \u003c 70) {\n  confidence = \"Medium\";\n} else if (value \u003e= 70 \u0026\u0026 value \u003c= 100) {\n  confidence = \"High\";\n} ctx.threat.indicator.put(\"confidence\", confidence)\n"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ['url'].contains(ctx.abusech.threatfox.ioc_type)",
                "value": "url"
              }
            },
            {
              "uri_parts": {
                "field": "abusech.threatfox.ioc",
                "if": "ctx.abusech?.threatfox?.ioc_type == 'url'",
                "keep_original": true,
                "remove_if_successful": true,
                "target_field": "threat.indicator.url"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ['domain'].contains(ctx.abusech.threatfox.ioc_type)",
                "value": "domain-name"
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.ioc",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ['domain'].contains(ctx.abusech.threatfox.ioc_type)",
                "ignore_missing": true,
                "target_field": "threat.indicator.url.domain"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ['ip:port'].contains(ctx.abusech.threatfox.ioc_type)",
                "value": "ipv4-addr"
              }
            },
            {
              "grok": {
                "field": "abusech.threatfox.ioc",
                "if": "ctx.abusech?.threatfox?.ioc_type == 'ip:port'",
                "ignore_missing": true,
                "patterns": [
                  "%{IP:threat.indicator.ip}:%{NUMBER:threat.indicator.port:long}"
                ]
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.threat?.indicator?.ip != null \u0026\u0026 ctx.threat.indicator.ip.contains(':')",
                "value": "ipv6-addr"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ['md5_hash', 'sha1_hash', 'sha256_hash'].contains(ctx.abusech.threatfox.ioc_type)",
                "value": "file"
              }
            },
            {
              "grok": {
                "field": "abusech.threatfox.ioc_type",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ctx.abusech?.threatfox?.ioc_type.endsWith('_hash')",
                "ignore_missing": true,
                "patterns": [
                  "%{DATA:_tmp.hashtype}_hash"
                ]
              }
            },
            {
              "rename": {
                "field": "abusech.threatfox.ioc",
                "if": "ctx.abusech?.threatfox?.ioc_type != null \u0026\u0026 ctx.abusech.threatfox.ioc_type.endsWith('_hash') \u0026\u0026 ctx._tmp.hashtype != null",
                "target_field": "threat.indicator.file.hash.{{{_tmp.hashtype}}}"
              }
            },
            {
              "foreach": {
                "field": "abusech.threatfox.tags",
                "if": "ctx.abusech?.threatfox?.tags instanceof List",
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "tags",
                    "value": "{{{_ingest._value}}}"
                  }
                }
              }
            },
            {
              "remove": {
                "field": "abusech.threatfox.tags",
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Indicator Expiration is done after `_conf.ioc_expiration_duration` (default 90d) since the indicator's last_seen time (if not present, then since first_seen). This script adds a default `abusech.threatfox.deleted_at` field to allow indicator expiration.",
                "if": "ctx.abusech?.threatfox?.deleted_at == null \u0026\u0026 ctx._conf?.ioc_expiration_duration != null \u0026\u0026 (ctx._conf.ioc_expiration_duration instanceof String) \u0026\u0026 ctx._conf.ioc_expiration_duration != ''",
                "lang": "painless",
                "source": "def dur = ctx._conf.ioc_expiration_duration; ZonedDateTime _tmp_deleted_at; ZonedDateTime _tmp_updated_at; if (ctx.threat.indicator.last_seen != null) {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.last_seen);\n} else {\n  _tmp_updated_at = ZonedDateTime.parse(ctx.threat.indicator.first_seen);\n} String time_unit = dur.substring(dur.length() -  1, dur.length()); String time_value = dur.substring(0, dur.length() - 1); if (time_unit == 'd') {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(Long.parseLong(time_value));\n} else if (time_unit == 'h') {\n  _tmp_deleted_at = _tmp_updated_at.plusHours(Long.parseLong(time_value));\n} else if (time_unit == 'm') {\n  _tmp_deleted_at = _tmp_updated_at.plusMinutes(Long.parseLong(time_value));\n} else {\n  _tmp_deleted_at = _tmp_updated_at.plusDays(90L);\n  if (ctx.error == null) {\n    ctx.error = new HashMap();\n  }\n  if (ctx.error.message == null) {\n    ctx.error.message = new ArrayList();\n  }\n  ctx.error.message.add('invalid ioc_expiration_duration: using default 90 days');\n} ctx.abusech.threatfox.deleted_at = _tmp_deleted_at;\n",
                "tag": "script-default-deleted_at"
              }
            },
            {
              "date": {
                "field": "abusech.threatfox.deleted_at",
                "formats": [
                  "ISO8601",
                  "UNIX"
                ],
                "tag": "date_deleted_at",
                "target_field": "abusech.threatfox.deleted_at"
              }
            },
            {
              "rename": {
                "field": "_conf.ioc_expiration_duration",
                "ignore_missing": true,
                "tag": "rename_conf_ioc_expiration_duration",
                "target_field": "abusech.threatfox.ioc_expiration_duration"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx?.threat?.indicator?.type == null",
                "value": "unknown"
              }
            },
            {
              "script": {
                "if": "ctx?.abusech != null",
                "lang": "painless",
                "source": "void handleMap(Map map) {\n  for (def x : map.values()) {\n    if (x instanceof Map) {\n        handleMap(x);\n    } else if (x instanceof List) {\n        handleList(x);\n    }\n  }\nmap.values().removeIf(v -\u003e v == null);\n}\nvoid handleList(List list) {\n  for (def x : list) {\n      if (x instanceof Map) {\n          handleMap(x);\n      } else if (x instanceof List) {\n          handleList(x);\n      }\n  }\n}\nhandleMap(ctx);\n"
              }
            },
            {
              "remove": {
                "field": [
                  "abusech.threatfox.first_seen",
                  "abusech.threatfox.last_seen",
                  "threatintel_indicator_confidence",
                  "abusech.threatfox.malware_alias",
                  "abusech.threatfox.ioc_type",
                  "abusech.threatfox.ioc",
                  "message",
                  "_tmp",
                  "_conf"
                ],
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Remove null/empty values recursively.",
                "lang": "painless",
                "source": "boolean drop(Object o) {\n  if (o == null || o == '') {\n    return true;\n  } else if (o instanceof Map) {\n    ((Map) o).values().removeIf(v -\u003e drop(v));\n    return (((Map) o).size() == 0);\n  } else if (o instanceof List) {\n    ((List) o).removeIf(v -\u003e drop(v));\n    return (((List) o).length == 0);\n  }\n  return false;\n}\ndrop(ctx);"
              }
            }
          ],
          "on_failure": [
            {
              "set": {
                "field": "event.kind",
                "value": "pipeline_error"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "tags",
                "value": "preserve_original_event"
              }
            },
            {
              "append": {
                "field": "error.message",
                "value": "Processor {{{ _ingest.on_failure_processor_type }}} {{{#_ingest.on_failure_processor_tag}}}with tag {{{ _ingest.on_failure_processor_tag }}} {{{/_ingest.on_failure_processor_tag}}}in pipeline {{{_ingest.pipeline}}} failed with message {{{ _ingest.on_failure_message }}}"
              }
            }
          ]
        }
      },
      "sample_event": {
        "event": {
          "@timestamp": "2024-04-17T15:15:32.910Z",
          "abusech": {
            "threatfox": {
              "confidence_level": 100,
              "deleted_at": "2022-08-10T19:43:08.000Z",
              "ioc_expiration_duration": "5d",
              "malware": "win.asyncrat",
              "threat_type": "botnet_cc",
              "threat_type_desc": "Indicator that identifies a botnet command&control server (C&C)"
            }
          },
          "agent": {
            "ephemeral_id": "231a6188-8b62-4608-857d-87c4cbb74f7c",
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "name": "docker-fleet-agent",
            "type": "filebeat",
            "version": "8.12.1"
          },
          "data_stream": {
            "dataset": "ti_abusech.threatfox",
            "namespace": "ep",
            "type": "logs"
          },
          "ecs": {
            "version": "8.11.0"
          },
          "elastic_agent": {
            "id": "60a22c30-4c80-4e95-b5b1-87ff540d8afd",
            "snapshot": false,
            "version": "8.12.1"
          },
          "event": {
            "agent_id_status": "verified",
            "category": [
              "threat"
            ],
            "dataset": "ti_abusech.threatfox",
            "id": "841537",
            "ingested": "2024-04-17T15:15:44Z",
            "kind": "enrichment",
            "original": "{\"confidence_level\":100,\"first_seen\":\"2022-08-05 19:43:08 UTC\",\"id\":\"841537\",\"ioc\":\"wizzy.hopto.org\",\"ioc_type\":\"domain\",\"ioc_type_desc\":\"Domain that is used for botnet Command\\u0026control (C\\u0026C)\",\"last_seen\":null,\"malware\":\"win.asyncrat\",\"malware_alias\":null,\"malware_malpedia\":\"https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat\",\"malware_printable\":\"AsyncRAT\",\"reference\":\"https://tria.ge/220805-w57pxsgae2\",\"reporter\":\"AndreGironda\",\"tags\":[\"asyncrat\"],\"threat_type\":\"botnet_cc\",\"threat_type_desc\":\"Indicator that identifies a botnet command\\u0026control server (C\\u0026C)\"}",
            "type": [
              "indicator"
            ]
          },
          "input": {
            "type": "cel"
          },
          "tags": [
            "preserve_original_event",
            "forwarded",
            "abusech-threatfox",
            "asyncrat"
          ],
          "threat": {
            "indicator": {
              "confidence": "High",
              "description": "Domain that is used for botnet Command&control (C&C)",
              "first_seen": "2022-08-05T19:43:08.000Z",
              "name": "wizzy.hopto.org",
              "provider": "AndreGironda",
              "reference": "https://tria.ge/220805-w57pxsgae2",
              "type": "domain-name",
              "url": {
                "domain": "wizzy.hopto.org"
              }
            },
            "software": {
              "name": "AsyncRAT",
              "reference": "https://malpedia.caad.fkie.fraunhofer.de/details/win.asyncrat"
            }
          }
        }
      },
      "fields": {
        "agent.yml": {
          "fields": [
            {
              "name": "cloud",
              "type": "group",
              "description": "Fields related to the cloud or infrastructure the events are coming from.",
              "fields": [
                {
                  "name": "image.id",
                  "type": "keyword",
                  "description": "Image ID for the cloud instance."
                }
              ],
              "_additional_attributes": {
                "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
                "group": 2,
                "title": "Cloud"
              }
            },
            {
              "name": "host",
              "type": "group",
              "description": "A host is defined as a general computing instance.  ECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
              "fields": [
                {
                  "name": "containerized",
                  "type": "boolean",
                  "description": "If the host is a container.\n"
                },
                {
                  "name": "os.build",
                  "type": "keyword",
                  "description": "OS build information.\n",
                  "example": "18D109"
                },
                {
                  "name": "os.codename",
                  "type": "keyword",
                  "description": "OS codename, if any.\n",
                  "example": "stretch"
                }
              ],
              "_additional_attributes": {
                "group": 2,
                "title": "Host"
              }
            }
          ]
        },
        "base-fields.yml": {
          "fields": [
            {
              "name": "data_stream.type",
              "type": "constant_keyword",
              "description": "Data stream type."
            },
            {
              "name": "data_stream.dataset",
              "type": "constant_keyword",
              "description": "Data stream dataset name."
            },
            {
              "name": "data_stream.namespace",
              "type": "constant_keyword",
              "description": "Data stream namespace."
            },
            {
              "name": "event.module",
              "type": "constant_keyword",
              "description": "Event module",
              "value": "ti_abusech"
            },
            {
              "name": "event.dataset",
              "type": "constant_keyword",
              "description": "Event dataset",
              "value": "ti_abusech.threatfox"
            },
            {
              "name": "threat.feed.name",
              "type": "constant_keyword",
              "description": "Display friendly feed name",
              "value": "AbuseCH Threat Fox"
            },
            {
              "name": "threat.feed.dashboard_id",
              "type": "constant_keyword",
              "description": "Dashboard ID used for Kibana CTI UI",
              "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
            },
            {
              "name": "@timestamp",
              "type": "date",
              "description": "Event timestamp."
            }
          ]
        },
        "beats.yml": {
          "fields": [
            {
              "name": "input.type",
              "type": "keyword",
              "description": "Type of Filebeat input."
            },
            {
              "name": "log.flags",
              "type": "keyword",
              "description": "Flags for the log file."
            },
            {
              "name": "log.offset",
              "type": "long",
              "description": "Offset of the entry in the log file."
            }
          ]
        },
        "ecs.yml": {
          "fields": [
            {
              "name": "threat.indicator.first_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.last_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.modified_at",
              "external": "ecs"
            }
          ]
        },
        "fields.yml": {
          "fields": [
            {
              "name": "abusech.threatfox",
              "type": "group",
              "description": "All fields related to AbuseCH Threat Fox indicators.",
              "fields": [
                {
                  "name": "tags",
                  "type": "keyword",
                  "description": "A list of tags associated with the queried malware sample.\n"
                },
                {
                  "name": "confidence_level",
                  "type": "long",
                  "description": "Confidence level between 0-100.\n"
                },
                {
                  "name": "malware",
                  "type": "keyword",
                  "description": "The malware associated with the IOC.\n"
                },
                {
                  "name": "threat_type",
                  "type": "keyword",
                  "description": "The type of threat.\n"
                },
                {
                  "name": "threat_type_desc",
                  "type": "keyword",
                  "description": "The threat descsription."
                },
                {
                  "name": "deleted_at",
                  "type": "date",
                  "description": "The indicator expiration timestamp.\n"
                },
                {
                  "name": "ioc_expiration_duration",
                  "type": "keyword",
                  "description": "The configured expiration duration.\n"
                }
              ]
            }
          ]
        },
        "is-ioc-transform-source-true.yml": {
          "fields": [
            {
              "name": "labels.is_ioc_transform_source",
              "type": "constant_keyword",
              "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
              "value": "true"
            }
          ]
        }
      }
    },
    "url": {
      "manifest": {
        "ilm_policy": "logs-ti_abusech.url-default_policy",
        "title": "AbuseCH URL logs",
        "type": "logs",
        "streams": [
          {
            "input": "cel",
            "description": "Collect AbuseCH URL logs using Elastic Agent",
            "title": "AbuseCH URL logs using Elastic Agent",
            "template_path": "cel.yml.hbs",
            "vars": [
              {
                "name": "url",
                "default": "https://urlhaus.abuse.ch/downloads/json",
                "description": "Active URL API fetches URLs that are either actively distributing malware or that have been added to URLhaus within the past 90 days.",
                "type": "text",
                "title": "AbuseCH Active URL API",
                "multi": false,
                "required": true,
                "show_user": false
              },
              {
                "name": "http_client_timeout",
                "default": "30s",
                "description": "Duration before declaring that the HTTP client connection has timed out. Valid time units are ns, us, ms, s, m, h.",
                "type": "text",
                "title": "HTTP Client Timeout",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "proxy_url",
                "description": "URL to proxy connections in the form of http\\[s\\]://<user>:<password>@<server name/ip>:<port>",
                "type": "text",
                "title": "Proxy URL",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "interval",
                "default": "1h",
                "description": "Interval for polling indicators from AbuseCH data dump. As data dump is generated every 5 minutes, it should be greater than 5 minutes. Default `1h`.",
                "type": "text",
                "title": "Interval",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "ssl",
                "description": "SSL configuration options. See [documentation](https://www.elastic.co/guide/en/beats/filebeat/current/configuration-ssl.html#ssl-common-config) for details.",
                "type": "yaml",
                "title": "SSL Configuration",
                "multi": false,
                "required": false,
                "show_user": false
              },
              {
                "name": "tags",
                "default": [
                  "forwarded",
                  "abusech-url"
                ],
                "type": "text",
                "title": "Tags",
                "multi": true,
                "required": true,
                "show_user": false
              },
              {
                "name": "preserve_original_event",
                "default": false,
                "description": "Preserves a raw copy of the original event, added to the field `event.original`",
                "type": "bool",
                "title": "Preserve original event",
                "multi": false,
                "required": true,
                "show_user": true
              },
              {
                "name": "processors",
                "description": "Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the logs are parsed. See [Processors](https://www.elastic.co/guide/en/beats/filebeat/current/filtering-and-enhancing-data.html) for details.\n",
                "type": "yaml",
                "title": "Processors",
                "multi": false,
                "required": false,
                "show_user": false
              }
            ],
            "enabled": true
          }
        ]
      },
      "pipelines": {
        "default.yml": {
          "description": "Pipeline for parsing Abuse.ch URL Threat Intel",
          "processors": [
            {
              "remove": {
                "description": "Removes the fields added by Agentless as metadata, as they can collide with ECS fields.",
                "field": [
                  "organization",
                  "division",
                  "team"
                ],
                "if": "ctx.organization instanceof String \u0026\u0026 ctx.division instanceof String \u0026\u0026 ctx.team instanceof String",
                "ignore_missing": true,
                "tag": "remove_agentless_tags"
              }
            },
            {
              "set": {
                "field": "ecs.version",
                "value": "8.11.0"
              }
            },
            {
              "set": {
                "field": "event.kind",
                "value": "enrichment"
              }
            },
            {
              "set": {
                "field": "event.category",
                "value": [
                  "threat"
                ]
              }
            },
            {
              "set": {
                "field": "event.type",
                "value": [
                  "indicator"
                ]
              }
            },
            {
              "set": {
                "copy_from": "_conf.interval",
                "field": "labels.interval",
                "if": "ctx._conf?.interval != null \u0026\u0026 ctx._conf.interval != ''"
              }
            },
            {
              "drop": {
                "description": "Drop if message is empty string return by CEL program.",
                "if": "ctx?.message == null || ctx.message == \"\""
              }
            },
            {
              "rename": {
                "field": "message",
                "if": "ctx.event?.original == null",
                "ignore_missing": true,
                "target_field": "event.original"
              }
            },
            {
              "remove": {
                "description": "The `message` field is no longer required if the document has an `event.original` field.",
                "field": "message",
                "if": "ctx.event?.original != null",
                "ignore_missing": true
              }
            },
            {
              "json": {
                "field": "event.original",
                "target_field": "abusech.url"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "value": "url"
              }
            },
            {
              "date": {
                "field": "abusech.url.date_added",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z"
                ],
                "if": "ctx.abusech?.url?.date_added != null",
                "target_field": "threat.indicator.first_seen"
              }
            },
            {
              "date": {
                "field": "abusech.url.dateadded",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z"
                ],
                "if": "ctx.abusech?.url?.dateadded != null \u0026\u0026 ctx.threat?.indicator?.first_seen == null",
                "target_field": "threat.indicator.first_seen"
              }
            },
            {
              "date": {
                "field": "abusech.url.last_online",
                "formats": [
                  "yyyy-MM-dd HH:mm:ss z",
                  "yyyy-MM-dd HH:mm:ss Z"
                ],
                "if": "ctx.abusech?.url?.last_online != null",
                "target_field": "threat.indicator.last_seen"
              }
            },
            {
              "remove": {
                "field": "abusech.url.last_online",
                "if": "ctx.threat?.indicator?.last_seen != null"
              }
            },
            {
              "set": {
                "copy_from": "abusech.url.url",
                "field": "threat.indicator.name",
                "tag": "set-indicator-name"
              }
            },
            {
              "uri_parts": {
                "field": "abusech.url.url",
                "if": "ctx.abusech?.url?.url != null",
                "keep_original": true,
                "remove_if_successful": true,
                "target_field": "threat.indicator.url"
              }
            },
            {
              "set": {
                "field": "threat.indicator.url.full",
                "ignore_empty_value": true,
                "value": "{{{threat.indicator.url.original}}}"
              }
            },
            {
              "rename": {
                "field": "abusech.url.urlhaus_reference",
                "ignore_missing": true,
                "target_field": "threat.indicator.reference"
              }
            },
            {
              "rename": {
                "field": "abusech.url.urlhaus_link",
                "if": "ctx.abusech?.url?.urlhaus_link != null \u0026\u0026 ctx.threat?.indicator?.reference == null",
                "ignore_missing": true,
                "target_field": "threat.indicator.reference"
              }
            },
            {
              "grok": {
                "field": "abusech.url.host",
                "if": "ctx.abusech?.url?.host != null",
                "ignore_failure": true,
                "patterns": [
                  "(?:%{IP:threat.indicator.ip}|%{GREEDYDATA:threat.indicator.url.domain})"
                ]
              }
            },
            {
              "rename": {
                "field": "abusech.url.reporter",
                "ignore_missing": true,
                "target_field": "threat.indicator.provider"
              }
            },
            {
              "foreach": {
                "field": "abusech.url.tags",
                "if": "ctx.abusech?.url?.tags instanceof List",
                "processor": {
                  "append": {
                    "allow_duplicates": false,
                    "field": "tags",
                    "value": "{{{_ingest._value}}}"
                  }
                }
              }
            },
            {
              "remove": {
                "field": "abusech.url.tags",
                "ignore_missing": true
              }
            },
            {
              "set": {
                "field": "event.ingested",
                "value": "{{{_ingest.timestamp}}}"
              }
            },
            {
              "script": {
                "description": "Indicator are expired after every `labels.interval` since `event.ingested`. This script adds a default `abusech.url.deleted_at` field to allow indicator expiration at the transform.",
                "if": "ctx.abusech?.url?.deleted_at == null \u0026\u0026 (ctx.labels.interval instanceof String)",
                "lang": "painless",
                "source": "def dur = ctx.labels.interval; ZonedDateTime _tmp_deleted_at; ZonedDateTime _tmp_created_at = ZonedDateTime.parse(ctx.event.ingested); long max_ingest_time_in_sec = 30L; long transform_max_age_in_min = 1L; String time_unit = dur.substring(dur.length() -  1, dur.length()); String time_value = dur.substring(0, dur.length() - 1); if (time_unit == 'd') {\n  _tmp_deleted_at = _tmp_created_at.plusDays(Long.parseLong(time_value));\n} else if (time_unit == 'h') {\n  _tmp_deleted_at = _tmp_created_at.plusHours(Long.parseLong(time_value));\n} else if (time_unit == 'm') {\n  _tmp_deleted_at = _tmp_created_at.plusMinutes(Long.parseLong(time_value));\n} else {\n  _tmp_deleted_at = _tmp_created_at.plusDays(90L);\n  if (ctx.error == null) {\n    ctx.error = new HashMap();\n  }\n  if (ctx.error.message == null) {\n    ctx.error.message = new ArrayList();\n  }\n  ctx.error.message.add('invalid ioc_expiration_duration: using default 90 days');\n} // Subtract transform's retention max_age and ingest time so that indicators are expire time slightly before next interval. // This ensures the indicator is deleted when the next interval starts.\n_tmp_deleted_at = _tmp_deleted_at.minusMinutes(transform_max_age_in_min).minusSeconds(max_ingest_time_in_sec); ctx.abusech.url.deleted_at = _tmp_deleted_at;\n",
                "tag": "script-default-deleted_at"
              }
            },
            {
              "date": {
                "field": "abusech.url.deleted_at",
                "formats": [
                  "ISO8601",
                  "UNIX"
                ],
                "tag": "date_deleted_at",
                "target_field": "abusech.url.deleted_at"
              }
            },
            {
              "set": {
                "field": "threat.indicator.type",
                "if": "ctx.threat?.indicator?.type == null",
                "value": "unknown"
              }
            },
            {
              "convert": {
                "field": "abusech.url.larted",
                "ignore_missing": true,
                "type": "boolean"
              }
            },
            {
              "script": {
                "if": "ctx.abusech != null",
                "lang": "painless",
                "source": "void handleMap(Map map) {\n  for (def x : map.values()) {\n    if (x instanceof Map) {\n        handleMap(x);\n    } else if (x instanceof List) {\n        handleList(x);\n    }\n  }\nmap.values().removeIf(v -\u003e v == null);\n}\nvoid handleList(List list) {\n  for (def x : list) {\n      if (x instanceof Map) {\n          handleMap(x);\n      } else if (x instanceof List) {\n          handleList(x);\n      }\n  }\n}\nhandleMap(ctx);\n"
              }
            },
            {
              "remove": {
                "field": [
                  "abusech.url.date_added",
                  "abusech.url.dateadded",
                  "abusech.url.url",
                  "abusech.url.host",
                  "message",
                  "_conf"
                ],
                "ignore_missing": true
              }
            },
            {
              "script": {
                "description": "Remove null/empty values recursively.",
                "lang": "painless",
                "source": "boolean drop(Object o) {\n  if (o == null || o == '') {\n    return true;\n  } else if (o instanceof Map) {\n    ((Map) o).values().removeIf(v -\u003e drop(v));\n    return (((Map) o).size() == 0);\n  } else if (o instanceof List) {\n    ((List) o).removeIf(v -\u003e drop(v));\n    return (((List) o).length == 0);\n  }\n  return false;\n}\ndrop(ctx);"
              }
            }
          ],
          "on_failure": [
            {
              "set": {
                "field": "event.kind",
                "value": "pipeline_error"
              }
            },
            {
              "append": {
                "allow_duplicates": false,
                "field": "tags",
                "value": "preserve_original_event"
              }
            },
            {
              "append": {
                "field": "error.message",
                "value": "Processor {{{ _ingest.on_failure_processor_type }}} {{{#_ingest.on_failure_processor_tag}}}with tag {{{ _ingest.on_failure_processor_tag }}} {{{/_ingest.on_failure_processor_tag}}}in pipeline {{{_ingest.pipeline}}} failed with message {{{ _ingest.on_failure_message }}}"
              }
            }
          ]
        }
      },
      "sample_event": {
        "event": {
          "@timestamp": "2024-04-17T19:13:14.065Z",
          "abusech": {
            "url": {
              "deleted_at": "2024-04-17T20:11:54.101Z",
              "id": "2786904",
              "threat": "malware_download",
              "url_status": "online"
            }
          },
          "agent": {
            "ephemeral_id": "513d3922-a070-424a-8ef7-4b9235936135",
            "id": "7f9f7ce6-d289-4b9b-92bc-f4c15b3c8db1",
            "name": "docker-fleet-agent",
            "type": "filebeat",
            "version": "8.12.1"
          },
          "data_stream": {
            "dataset": "ti_abusech.url",
            "namespace": "ep",
            "type": "logs"
          },
          "ecs": {
            "version": "8.11.0"
          },
          "elastic_agent": {
            "id": "7f9f7ce6-d289-4b9b-92bc-f4c15b3c8db1",
            "snapshot": false,
            "version": "8.12.1"
          },
          "event": {
            "agent_id_status": "verified",
            "category": [
              "threat"
            ],
            "dataset": "ti_abusech.url",
            "ingested": "2024-04-17T19:13:24Z",
            "kind": "enrichment",
            "original": "{\"dateadded\":\"2024-03-19 11:34:09 UTC\",\"id\":\"2786904\",\"last_online\":\"2024-03-19 11:34:09 UTC\",\"reporter\":\"lrz_urlhaus\",\"tags\":[\"elf\",\"Mozi\"],\"threat\":\"malware_download\",\"url\":\"http://115.55.244.160:41619/Mozi.m\",\"url_status\":\"online\",\"urlhaus_link\":\"https://urlhaus.abuse.ch/url/2786904/\"}",
            "type": [
              "indicator"
            ]
          },
          "input": {
            "type": "cel"
          },
          "labels": {
            "interval": "1h"
          },
          "tags": [
            "preserve_original_event",
            "forwarded",
            "abusech-url",
            "elf",
            "Mozi"
          ],
          "threat": {
            "indicator": {
              "first_seen": "2024-03-19T11:34:09.000Z",
              "last_seen": "2024-03-19T11:34:09.000Z",
              "name": "http://115.55.244.160:41619/Mozi.m",
              "provider": "lrz_urlhaus",
              "reference": "https://urlhaus.abuse.ch/url/2786904/",
              "type": "url",
              "url": {
                "domain": "115.55.244.160",
                "extension": "m",
                "full": "http://115.55.244.160:41619/Mozi.m",
                "original": "http://115.55.244.160:41619/Mozi.m",
                "path": "/Mozi.m",
                "port": 41619,
                "scheme": "http"
              }
            }
          }
        }
      },
      "fields": {
        "agent.yml": {
          "fields": [
            {
              "name": "cloud",
              "type": "group",
              "description": "Fields related to the cloud or infrastructure the events are coming from.",
              "fields": [
                {
                  "name": "image.id",
                  "type": "keyword",
                  "description": "Image ID for the cloud instance."
                }
              ],
              "_additional_attributes": {
                "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
                "group": 2,
                "title": "Cloud"
              }
            },
            {
              "name": "host",
              "type": "group",
              "description": "A host is defined as a general computing instance.  ECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
              "fields": [
                {
                  "name": "containerized",
                  "type": "boolean",
                  "description": "If the host is a container.\n"
                },
                {
                  "name": "os.build",
                  "type": "keyword",
                  "description": "OS build information.\n",
                  "example": "18D109"
                },
                {
                  "name": "os.codename",
                  "type": "keyword",
                  "description": "OS codename, if any.\n",
                  "example": "stretch"
                }
              ],
              "_additional_attributes": {
                "group": 2,
                "title": "Host"
              }
            }
          ]
        },
        "base-fields.yml": {
          "fields": [
            {
              "name": "data_stream.type",
              "type": "constant_keyword",
              "description": "Data stream type."
            },
            {
              "name": "data_stream.dataset",
              "type": "constant_keyword",
              "description": "Data stream dataset name."
            },
            {
              "name": "data_stream.namespace",
              "type": "constant_keyword",
              "description": "Data stream namespace."
            },
            {
              "name": "event.module",
              "type": "constant_keyword",
              "description": "Event module",
              "value": "ti_abusech"
            },
            {
              "name": "event.dataset",
              "type": "constant_keyword",
              "description": "Event dataset",
              "value": "ti_abusech.url"
            },
            {
              "name": "threat.feed.name",
              "type": "constant_keyword",
              "description": "Display friendly feed name",
              "value": "AbuseCH URL"
            },
            {
              "name": "threat.feed.dashboard_id",
              "type": "constant_keyword",
              "description": "Dashboard ID used for Kibana CTI UI",
              "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
            },
            {
              "name": "@timestamp",
              "type": "date",
              "description": "Event timestamp."
            }
          ]
        },
        "beats.yml": {
          "fields": [
            {
              "name": "input.type",
              "type": "keyword",
              "description": "Type of Filebeat input."
            },
            {
              "name": "log.flags",
              "type": "keyword",
              "description": "Flags for the log file."
            },
            {
              "name": "log.offset",
              "type": "long",
              "description": "Offset of the entry in the log file."
            }
          ]
        },
        "ecs.yml": {
          "fields": [
            {
              "name": "threat.indicator.first_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.last_seen",
              "external": "ecs"
            },
            {
              "name": "threat.indicator.modified_at",
              "external": "ecs"
            }
          ]
        },
        "fields.yml": {
          "fields": [
            {
              "name": "abusech.url",
              "type": "group",
              "description": "All fields related to AbuseCH URL indicators.",
              "fields": [
                {
                  "name": "id",
                  "type": "keyword",
                  "description": "The ID of the indicator.\n"
                },
                {
                  "name": "last_online",
                  "type": "date",
                  "description": "Last timestamp when the URL has been serving malware.\n"
                },
                {
                  "name": "deleted_at",
                  "type": "date",
                  "description": "The timestamp when the indicator is (will be) deleted.\n"
                },
                {
                  "name": "urlhaus_reference",
                  "type": "keyword",
                  "description": "Link to URLhaus entry.\n"
                },
                {
                  "name": "url_status",
                  "type": "keyword",
                  "description": "The current status of the URL. Possible values are: online, offline and unknown.\n"
                },
                {
                  "name": "threat",
                  "type": "keyword",
                  "description": "The threat corresponding to this malware URL.\n"
                },
                {
                  "name": "reporter",
                  "type": "keyword",
                  "description": "The Twitter handle of the reporter that has reported this malware URL (or anonymous).\n"
                },
                {
                  "name": "larted",
                  "type": "boolean",
                  "description": "Indicates whether the malware URL has been reported to the hosting provider (true or false).\n"
                },
                {
                  "name": "tags",
                  "type": "keyword",
                  "description": "A list of tags associated with the queried malware URL.\n"
                },
                {
                  "name": "blacklists.spamhaus_dbl",
                  "type": "keyword",
                  "description": "If the indicator is listed on the spamhaus blacklist.\n"
                },
                {
                  "name": "blacklists.surbl",
                  "type": "keyword",
                  "description": "If the indicator is listed on the surbl blacklist.\n"
                }
              ]
            },
            {
              "name": "labels.interval",
              "type": "keyword",
              "description": "User-configured value for `Interval` setting. This is used in calculation of indicator expiration time."
            }
          ]
        },
        "is-ioc-transform-source-true.yml": {
          "fields": [
            {
              "name": "labels.is_ioc_transform_source",
              "type": "constant_keyword",
              "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
              "value": "true"
            }
          ]
        }
      }
    }
  },
  "transforms": {
    "latest_malware": {
      "transform": {
        "source": {
          "index": [
            "logs-ti_abusech.malware-*"
          ],
          "query": {
            "bool": {
              "must_not": {
                "exists": {
                  "field": "error.message"
                }
              }
            }
          }
        },
        "dest": {
          "index": "logs-ti_abusech_latest.dest_malware-3",
          "aliases": [
            {
              "alias": "logs-ti_abusech_latest.malware",
              "move_on_creation": true
            }
          ]
        },
        "latest": {
          "sort": "@timestamp",
          "unique_key": [
            "event.dataset",
            "threat.indicator.file.hash.md5",
            "threat.indicator.file.hash.sha256"
          ]
        },
        "description": "Latest Abuse CH Malware Bazaar indicators.",
        "frequency": "30s",
        "_meta": {
          "fleet_transform_version": "0.3.0",
          "managed": true
        },
        "retention_policy": {
          "time": {
            "field": "abusech.malware.deleted_at",
            "max_age": "1m"
          }
        },
        "sync": {
          "time": {
            "field": "event.ingested",
            "delay": "120s"
          }
        }
      },
      "manifest": {
        "destination_index_template": {
          "mappings": {},
          "settings": {
            "index": {
              "sort": {
                "field": [
                  "@timestamp"
                ],
                "order": [
                  "desc"
                ]
              }
            }
          }
        },
        "start": true
      },
      "fields": [
        {
          "name": "cloud",
          "type": "group",
          "description": "Fields related to the cloud or infrastructure the events are coming from.",
          "fields": [
            {
              "name": "account.id",
              "type": "keyword",
              "description": "The cloud account or organization id used to identify different entities in a multi-tenant environment.\nExamples: AWS account id, Google Cloud ORG Id, or other unique identifier.",
              "example": 666777888999,
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "availability_zone",
              "type": "keyword",
              "description": "Availability zone in which this host is running.",
              "example": "us-east-1c",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.id",
              "type": "keyword",
              "description": "Instance ID of the host machine.",
              "example": "i-1234567890abcdef0",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.name",
              "type": "keyword",
              "description": "Instance name of the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "machine.type",
              "type": "keyword",
              "description": "Machine type of the host machine.",
              "example": "t2.medium",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "provider",
              "type": "keyword",
              "description": "Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.",
              "example": "aws",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "region",
              "type": "keyword",
              "description": "Region in which this host is running.",
              "example": "us-east-1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "project.id",
              "type": "keyword",
              "description": "Name of the project in Google Cloud."
            },
            {
              "name": "image.id",
              "type": "keyword",
              "description": "Image ID for the cloud instance."
            }
          ],
          "_additional_attributes": {
            "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
            "group": 2,
            "title": "Cloud"
          }
        },
        {
          "name": "container",
          "type": "group",
          "description": "Container fields are used for meta information about the specific container that is the source of information.\nThese fields help correlate data based containers from any runtime.",
          "fields": [
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique container id.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "image.name",
              "type": "keyword",
              "description": "Name of the image the container was built on.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "labels",
              "type": "object",
              "description": "Image labels.",
              "object_type": "keyword",
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Container name.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Container"
          }
        },
        {
          "name": "host",
          "type": "group",
          "description": "A host is defined as a general computing instance.\nECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
          "fields": [
            {
              "name": "architecture",
              "type": "keyword",
              "description": "Operating system architecture.",
              "example": "x86_64",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "domain",
              "type": "keyword",
              "description": "Name of the domain of which the host is a member.\nFor example, on Windows this could be the host's Active Directory domain or NetBIOS domain name. For Linux this could be the domain of the host's LDAP provider.",
              "example": "CONTOSO",
              "ignore_above": 1024,
              "_additional_attributes": {
                "default_field": false,
                "level": "extended"
              }
            },
            {
              "name": "hostname",
              "type": "keyword",
              "description": "Hostname of the host.\nIt normally contains what the `hostname` command returns on the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique host id.\nAs hostname is not always unique, use values that are meaningful in your environment.\nExample: The current usage of `beat.name`.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "ip",
              "type": "ip",
              "description": "Host ip addresses.",
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "mac",
              "type": "keyword",
              "description": "Host mac addresses.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Name of the host.\nIt can contain what `hostname` returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "os.family",
              "type": "keyword",
              "description": "OS family (such as redhat, debian, freebsd, windows).",
              "example": "debian",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.kernel",
              "type": "keyword",
              "description": "Operating system kernel version as a raw string.",
              "example": "4.4.0-112-generic",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.name",
              "type": "keyword",
              "description": "Operating system name, without the version.",
              "example": "Mac OS X",
              "multi_fields": [
                {
                  "name": "text",
                  "type": "text",
                  "_additional_attributes": {
                    "default_field": false,
                    "norms": false
                  }
                }
              ],
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.platform",
              "type": "keyword",
              "description": "Operating system platform (such centos, ubuntu, windows).",
              "example": "darwin",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.version",
              "type": "keyword",
              "description": "Operating system version as a raw string.",
              "example": "10.14.1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "type",
              "type": "keyword",
              "description": "Type of host.\nFor Cloud providers this can be the machine type like `t2.medium`. If vm, this could be the container, for example, or other information meaningful in your environment.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "containerized",
              "type": "boolean",
              "description": "If the host is a container.\n"
            },
            {
              "name": "os.build",
              "type": "keyword",
              "description": "OS build information.\n",
              "example": "18D109"
            },
            {
              "name": "os.codename",
              "type": "keyword",
              "description": "OS codename, if any.\n",
              "example": "stretch"
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Host"
          }
        },
        {
          "name": "data_stream.type",
          "type": "constant_keyword",
          "description": "Data stream type."
        },
        {
          "name": "data_stream.dataset",
          "type": "constant_keyword",
          "description": "Data stream dataset name."
        },
        {
          "name": "data_stream.namespace",
          "type": "constant_keyword",
          "description": "Data stream namespace."
        },
        {
          "name": "@timestamp",
          "type": "date",
          "description": "Event timestamp."
        },
        {
          "name": "input.type",
          "type": "keyword",
          "description": "Type of Filebeat input."
        },
        {
          "name": "log.flags",
          "type": "keyword",
          "description": "Flags for the log file."
        },
        {
          "name": "log.offset",
          "type": "long",
          "description": "Offset of the entry in the log file."
        },
        {
          "name": "log.file.path",
          "type": "keyword",
          "description": "Path to the log file."
        },
        {
          "name": "ecs.version",
          "external": "ecs"
        },
        {
          "name": "message",
          "external": "ecs"
        },
        {
          "name": "error.message",
          "external": "ecs"
        },
        {
          "name": "tags",
          "external": "ecs"
        },
        {
          "name": "related.hash",
          "external": "ecs"
        },
        {
          "name": "event.created",
          "external": "ecs"
        },
        {
          "name": "event.ingested",
          "external": "ecs"
        },
        {
          "name": "event.kind",
          "external": "ecs"
        },
        {
          "name": "event.category",
          "external": "ecs"
        },
        {
          "name": "event.type",
          "external": "ecs"
        },
        {
          "name": "event.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.type",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.first_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.size",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.type",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.md5",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha256",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.pe.imphash",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.ssdeep",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.tlsh",
          "type": "keyword",
          "description": "The file's import tlsh, if available."
        },
        {
          "name": "threat.indicator.provider",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.name",
          "external": "ecs"
        },
        {
          "name": "labels",
          "external": "ecs"
        },
        {
          "name": "event.module",
          "type": "constant_keyword",
          "description": "Event module",
          "value": "ti_abusech"
        },
        {
          "name": "event.dataset",
          "type": "constant_keyword",
          "description": "Event dataset",
          "value": "ti_abusech.malware"
        },
        {
          "name": "threat.feed.name",
          "type": "constant_keyword",
          "description": "Display friendly feed name",
          "value": "AbuseCH Malware"
        },
        {
          "name": "threat.feed.dashboard_id",
          "type": "constant_keyword",
          "description": "Dashboard ID used for Kibana CTI UI",
          "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
        },
        {
          "name": "abusech.malware",
          "type": "group",
          "description": "All fields related to AbuseCH URL indicators.",
          "fields": [
            {
              "name": "signature",
              "type": "keyword",
              "description": "Malware family.\n"
            },
            {
              "name": "virustotal.result",
              "type": "keyword",
              "description": "AV detection ratio.\n"
            },
            {
              "name": "virustotal.percent",
              "type": "float",
              "description": "AV detection in percent.\n"
            },
            {
              "name": "virustotal.link",
              "type": "keyword",
              "description": "Link to the Virustotal report.\n"
            },
            {
              "name": "deleted_at",
              "type": "date",
              "description": "The indicator expiration timestamp.\n"
            },
            {
              "name": "ioc_expiration_duration",
              "type": "keyword",
              "description": "The configured expiration duration.\n"
            }
          ]
        },
        {
          "name": "labels.is_ioc_transform_source",
          "type": "constant_keyword",
          "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
          "value": "false"
        }
      ]
    },
    "latest_malwarebazaar": {
      "transform": {
        "source": {
          "index": [
            "logs-ti_abusech.malwarebazaar-*"
          ],
          "query": {
            "bool": {
              "must_not": {
                "exists": {
                  "field": "error.message"
                }
              }
            }
          }
        },
        "dest": {
          "index": "logs-ti_abusech_latest.dest_malwarebazaar-3",
          "aliases": [
            {
              "alias": "logs-ti_abusech_latest.malwarebazaar",
              "move_on_creation": true
            }
          ]
        },
        "latest": {
          "sort": "@timestamp",
          "unique_key": [
            "event.dataset",
            "threat.indicator.file.hash.md5",
            "threat.indicator.file.hash.sha256"
          ]
        },
        "description": "Latest Abuse CH Malware Bazaar indicators.",
        "frequency": "30s",
        "_meta": {
          "fleet_transform_version": "0.3.0",
          "managed": true
        },
        "retention_policy": {
          "time": {
            "field": "abusech.malwarebazaar.deleted_at",
            "max_age": "1m"
          }
        },
        "sync": {
          "time": {
            "field": "event.ingested",
            "delay": "120s"
          }
        }
      },
      "manifest": {
        "destination_index_template": {
          "mappings": {},
          "settings": {
            "index": {
              "sort": {
                "field": [
                  "@timestamp"
                ],
                "order": [
                  "desc"
                ]
              }
            }
          }
        },
        "start": true
      },
      "fields": [
        {
          "name": "cloud",
          "type": "group",
          "description": "Fields related to the cloud or infrastructure the events are coming from.",
          "fields": [
            {
              "name": "account.id",
              "type": "keyword",
              "description": "The cloud account or organization id used to identify different entities in a multi-tenant environment.\nExamples: AWS account id, Google Cloud ORG Id, or other unique identifier.",
              "example": 666777888999,
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "availability_zone",
              "type": "keyword",
              "description": "Availability zone in which this host is running.",
              "example": "us-east-1c",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.id",
              "type": "keyword",
              "description": "Instance ID of the host machine.",
              "example": "i-1234567890abcdef0",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.name",
              "type": "keyword",
              "description": "Instance name of the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "machine.type",
              "type": "keyword",
              "description": "Machine type of the host machine.",
              "example": "t2.medium",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "provider",
              "type": "keyword",
              "description": "Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.",
              "example": "aws",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "region",
              "type": "keyword",
              "description": "Region in which this host is running.",
              "example": "us-east-1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "project.id",
              "type": "keyword",
              "description": "Name of the project in Google Cloud."
            },
            {
              "name": "image.id",
              "type": "keyword",
              "description": "Image ID for the cloud instance."
            }
          ],
          "_additional_attributes": {
            "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
            "group": 2,
            "title": "Cloud"
          }
        },
        {
          "name": "container",
          "type": "group",
          "description": "Container fields are used for meta information about the specific container that is the source of information.\nThese fields help correlate data based containers from any runtime.",
          "fields": [
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique container id.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "image.name",
              "type": "keyword",
              "description": "Name of the image the container was built on.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "labels",
              "type": "object",
              "description": "Image labels.",
              "object_type": "keyword",
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Container name.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Container"
          }
        },
        {
          "name": "host",
          "type": "group",
          "description": "A host is defined as a general computing instance.\nECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
          "fields": [
            {
              "name": "architecture",
              "type": "keyword",
              "description": "Operating system architecture.",
              "example": "x86_64",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "domain",
              "type": "keyword",
              "description": "Name of the domain of which the host is a member.\nFor example, on Windows this could be the host's Active Directory domain or NetBIOS domain name. For Linux this could be the domain of the host's LDAP provider.",
              "example": "CONTOSO",
              "ignore_above": 1024,
              "_additional_attributes": {
                "default_field": false,
                "level": "extended"
              }
            },
            {
              "name": "hostname",
              "type": "keyword",
              "description": "Hostname of the host.\nIt normally contains what the `hostname` command returns on the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique host id.\nAs hostname is not always unique, use values that are meaningful in your environment.\nExample: The current usage of `beat.name`.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "ip",
              "type": "ip",
              "description": "Host ip addresses.",
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "mac",
              "type": "keyword",
              "description": "Host mac addresses.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Name of the host.\nIt can contain what `hostname` returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "os.family",
              "type": "keyword",
              "description": "OS family (such as redhat, debian, freebsd, windows).",
              "example": "debian",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.kernel",
              "type": "keyword",
              "description": "Operating system kernel version as a raw string.",
              "example": "4.4.0-112-generic",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.name",
              "type": "keyword",
              "description": "Operating system name, without the version.",
              "example": "Mac OS X",
              "multi_fields": [
                {
                  "name": "text",
                  "type": "text",
                  "_additional_attributes": {
                    "default_field": false,
                    "norms": false
                  }
                }
              ],
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.platform",
              "type": "keyword",
              "description": "Operating system platform (such centos, ubuntu, windows).",
              "example": "darwin",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.version",
              "type": "keyword",
              "description": "Operating system version as a raw string.",
              "example": "10.14.1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "type",
              "type": "keyword",
              "description": "Type of host.\nFor Cloud providers this can be the machine type like `t2.medium`. If vm, this could be the container, for example, or other information meaningful in your environment.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "containerized",
              "type": "boolean",
              "description": "If the host is a container.\n"
            },
            {
              "name": "os.build",
              "type": "keyword",
              "description": "OS build information.\n",
              "example": "18D109"
            },
            {
              "name": "os.codename",
              "type": "keyword",
              "description": "OS codename, if any.\n",
              "example": "stretch"
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Host"
          }
        },
        {
          "name": "data_stream.type",
          "type": "constant_keyword",
          "description": "Data stream type."
        },
        {
          "name": "data_stream.dataset",
          "type": "constant_keyword",
          "description": "Data stream dataset name."
        },
        {
          "name": "data_stream.namespace",
          "type": "constant_keyword",
          "description": "Data stream namespace."
        },
        {
          "name": "@timestamp",
          "type": "date",
          "description": "Event timestamp."
        },
        {
          "name": "input.type",
          "type": "keyword",
          "description": "Type of Filebeat input."
        },
        {
          "name": "log.flags",
          "type": "keyword",
          "description": "Flags for the log file."
        },
        {
          "name": "log.offset",
          "type": "long",
          "description": "Offset of the entry in the log file."
        },
        {
          "name": "log.file.path",
          "type": "keyword",
          "description": "Path to the log file."
        },
        {
          "name": "ecs.version",
          "external": "ecs"
        },
        {
          "name": "message",
          "external": "ecs"
        },
        {
          "name": "error.message",
          "external": "ecs"
        },
        {
          "name": "tags",
          "external": "ecs"
        },
        {
          "name": "related.hash",
          "external": "ecs"
        },
        {
          "name": "event.ingested",
          "external": "ecs"
        },
        {
          "name": "event.kind",
          "external": "ecs"
        },
        {
          "name": "event.category",
          "external": "ecs"
        },
        {
          "name": "event.type",
          "external": "ecs"
        },
        {
          "name": "event.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.type",
          "external": "ecs"
        },
        {
          "name": "event.created",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.first_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.last_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.size",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.type",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.name",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.extension",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha1",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.mime_type",
          "external": "ecs"
        },
        {
          "name": "threat.software.alias",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.md5",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha256",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.ssdeep",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha384",
          "type": "keyword",
          "description": "The file's sha384 hash, if available."
        },
        {
          "name": "threat.indicator.file.hash.tlsh",
          "type": "keyword",
          "description": "The file's import tlsh, if available."
        },
        {
          "name": "threat.indicator.file.pe.imphash",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.elf.telfhash",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.subject.common_name",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.issuer.common_name",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.public_key_algorithm",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.not_before",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.not_after",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.x509.serial_number",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.provider",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.geo.country_iso_code",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.name",
          "external": "ecs"
        },
        {
          "name": "labels",
          "external": "ecs"
        },
        {
          "name": "event.module",
          "type": "constant_keyword",
          "description": "Event module",
          "value": "ti_abusech"
        },
        {
          "name": "event.dataset",
          "type": "constant_keyword",
          "description": "Event dataset",
          "value": "ti_abusech.malwarebazaar"
        },
        {
          "name": "threat.feed.name",
          "type": "constant_keyword",
          "description": "Display friendly feed name",
          "value": "AbuseCH MalwareBazaar"
        },
        {
          "name": "threat.feed.dashboard_id",
          "type": "constant_keyword",
          "description": "Dashboard ID used for Kibana CTI UI",
          "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
        },
        {
          "name": "abusech.malwarebazaar",
          "type": "group",
          "description": "All fields related to AbuseCH URL indicators.",
          "fields": [
            {
              "name": "intelligence",
              "type": "group",
              "fields": [
                {
                  "name": "downloads",
                  "type": "long",
                  "description": "Number of downloads from MalwareBazaar.\n"
                },
                {
                  "name": "uploads",
                  "type": "long",
                  "description": "Number of uploads from MalwareBazaar.\n"
                },
                {
                  "name": "mail",
                  "type": "group",
                  "fields": [
                    {
                      "name": "Generic",
                      "type": "keyword",
                      "description": "Malware seen in generic spam traffic.\n"
                    },
                    {
                      "name": "IT",
                      "type": "keyword",
                      "description": "Malware seen in IT spam traffic.\n"
                    }
                  ]
                }
              ]
            },
            {
              "name": "anonymous",
              "type": "long",
              "description": "Identifies if the sample was submitted anonymously.\n"
            },
            {
              "name": "dhash_icon",
              "type": "keyword",
              "description": "In case the file is a PE executable: dhash of the samples icon.\n"
            },
            {
              "name": "code_sign",
              "type": "group",
              "description": "Code signing information for the sample.\n",
              "fields": [
                {
                  "name": "algorithm",
                  "type": "keyword",
                  "description": "Algorithm used to generate the public key.\n"
                },
                {
                  "name": "cscb_listed",
                  "type": "boolean",
                  "description": "Whether the certificate is present on the Code Signing Certificate Blocklist (CSCB).\n"
                },
                {
                  "name": "cscb_reason",
                  "type": "keyword",
                  "description": "Why the certificate is present on the Code Signing Certificate Blocklist (CSCB).\n"
                },
                {
                  "name": "issuer_cn",
                  "type": "keyword",
                  "description": "Common name (CN) of issuing certificate authority.\n"
                },
                {
                  "name": "serial_number",
                  "type": "keyword",
                  "description": "Unique serial number issued by the certificate authority.\n"
                },
                {
                  "name": "subject_cn",
                  "type": "keyword",
                  "description": "Common name (CN) of subject.\n"
                },
                {
                  "name": "thumbprint",
                  "type": "keyword",
                  "description": "Hash of certificate.\n"
                },
                {
                  "name": "thumbprint_algorithm",
                  "type": "keyword",
                  "description": "Algorithm used to create thumbprint.\n"
                },
                {
                  "name": "valid_from",
                  "type": "date",
                  "description": "Time at which the certificate is first considered valid.\n"
                },
                {
                  "name": "valid_to",
                  "type": "keyword",
                  "description": "Time at which the certificate is no longer considered valid.\n"
                }
              ]
            },
            {
              "name": "deleted_at",
              "type": "date",
              "description": "The indicator expiration timestamp.\n"
            },
            {
              "name": "ioc_expiration_duration",
              "type": "keyword",
              "description": "The configured expiration duration.\n"
            }
          ]
        },
        {
          "name": "labels.is_ioc_transform_source",
          "type": "constant_keyword",
          "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
          "value": "false"
        }
      ]
    },
    "latest_threatfox": {
      "transform": {
        "source": {
          "index": [
            "logs-ti_abusech.threatfox-*"
          ],
          "query": {
            "bool": {
              "must_not": {
                "exists": {
                  "field": "error.message"
                }
              }
            }
          }
        },
        "dest": {
          "index": "logs-ti_abusech_latest.dest_threatfox-3",
          "aliases": [
            {
              "alias": "logs-ti_abusech_latest.threatfox",
              "move_on_creation": true
            }
          ]
        },
        "latest": {
          "sort": "@timestamp",
          "unique_key": [
            "event.dataset",
            "event.id"
          ]
        },
        "description": "Latest Abuse CH Threat Fox data.",
        "frequency": "30s",
        "_meta": {
          "fleet_transform_version": "0.3.0",
          "managed": true
        },
        "retention_policy": {
          "time": {
            "field": "abusech.threatfox.deleted_at",
            "max_age": "1m"
          }
        },
        "sync": {
          "time": {
            "field": "event.ingested",
            "delay": "120s"
          }
        }
      },
      "manifest": {
        "destination_index_template": {
          "mappings": {},
          "settings": {
            "index": {
              "sort": {
                "field": [
                  "@timestamp"
                ],
                "order": [
                  "desc"
                ]
              }
            }
          }
        },
        "start": true
      },
      "fields": [
        {
          "name": "cloud",
          "type": "group",
          "description": "Fields related to the cloud or infrastructure the events are coming from.",
          "fields": [
            {
              "name": "account.id",
              "type": "keyword",
              "description": "The cloud account or organization id used to identify different entities in a multi-tenant environment.\nExamples: AWS account id, Google Cloud ORG Id, or other unique identifier.",
              "example": 666777888999,
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "availability_zone",
              "type": "keyword",
              "description": "Availability zone in which this host is running.",
              "example": "us-east-1c",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.id",
              "type": "keyword",
              "description": "Instance ID of the host machine.",
              "example": "i-1234567890abcdef0",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.name",
              "type": "keyword",
              "description": "Instance name of the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "machine.type",
              "type": "keyword",
              "description": "Machine type of the host machine.",
              "example": "t2.medium",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "provider",
              "type": "keyword",
              "description": "Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.",
              "example": "aws",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "region",
              "type": "keyword",
              "description": "Region in which this host is running.",
              "example": "us-east-1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "project.id",
              "type": "keyword",
              "description": "Name of the project in Google Cloud."
            },
            {
              "name": "image.id",
              "type": "keyword",
              "description": "Image ID for the cloud instance."
            }
          ],
          "_additional_attributes": {
            "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
            "group": 2,
            "title": "Cloud"
          }
        },
        {
          "name": "container",
          "type": "group",
          "description": "Container fields are used for meta information about the specific container that is the source of information.\nThese fields help correlate data based containers from any runtime.",
          "fields": [
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique container id.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "image.name",
              "type": "keyword",
              "description": "Name of the image the container was built on.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "labels",
              "type": "object",
              "description": "Image labels.",
              "object_type": "keyword",
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Container name.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Container"
          }
        },
        {
          "name": "host",
          "type": "group",
          "description": "A host is defined as a general computing instance.\nECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
          "fields": [
            {
              "name": "architecture",
              "type": "keyword",
              "description": "Operating system architecture.",
              "example": "x86_64",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "domain",
              "type": "keyword",
              "description": "Name of the domain of which the host is a member.\nFor example, on Windows this could be the host's Active Directory domain or NetBIOS domain name. For Linux this could be the domain of the host's LDAP provider.",
              "example": "CONTOSO",
              "ignore_above": 1024,
              "_additional_attributes": {
                "default_field": false,
                "level": "extended"
              }
            },
            {
              "name": "hostname",
              "type": "keyword",
              "description": "Hostname of the host.\nIt normally contains what the `hostname` command returns on the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique host id.\nAs hostname is not always unique, use values that are meaningful in your environment.\nExample: The current usage of `beat.name`.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "ip",
              "type": "ip",
              "description": "Host ip addresses.",
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "mac",
              "type": "keyword",
              "description": "Host mac addresses.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Name of the host.\nIt can contain what `hostname` returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "os.family",
              "type": "keyword",
              "description": "OS family (such as redhat, debian, freebsd, windows).",
              "example": "debian",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.kernel",
              "type": "keyword",
              "description": "Operating system kernel version as a raw string.",
              "example": "4.4.0-112-generic",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.name",
              "type": "keyword",
              "description": "Operating system name, without the version.",
              "example": "Mac OS X",
              "multi_fields": [
                {
                  "name": "text",
                  "type": "text",
                  "_additional_attributes": {
                    "default_field": false,
                    "norms": false
                  }
                }
              ],
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.platform",
              "type": "keyword",
              "description": "Operating system platform (such centos, ubuntu, windows).",
              "example": "darwin",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.version",
              "type": "keyword",
              "description": "Operating system version as a raw string.",
              "example": "10.14.1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "type",
              "type": "keyword",
              "description": "Type of host.\nFor Cloud providers this can be the machine type like `t2.medium`. If vm, this could be the container, for example, or other information meaningful in your environment.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "containerized",
              "type": "boolean",
              "description": "If the host is a container.\n"
            },
            {
              "name": "os.build",
              "type": "keyword",
              "description": "OS build information.\n",
              "example": "18D109"
            },
            {
              "name": "os.codename",
              "type": "keyword",
              "description": "OS codename, if any.\n",
              "example": "stretch"
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Host"
          }
        },
        {
          "name": "data_stream.type",
          "type": "constant_keyword",
          "description": "Data stream type."
        },
        {
          "name": "data_stream.dataset",
          "type": "constant_keyword",
          "description": "Data stream dataset name."
        },
        {
          "name": "data_stream.namespace",
          "type": "constant_keyword",
          "description": "Data stream namespace."
        },
        {
          "name": "@timestamp",
          "type": "date",
          "description": "Event timestamp."
        },
        {
          "name": "input.type",
          "type": "keyword",
          "description": "Type of Filebeat input."
        },
        {
          "name": "log.flags",
          "type": "keyword",
          "description": "Flags for the log file."
        },
        {
          "name": "log.offset",
          "type": "long",
          "description": "Offset of the entry in the log file."
        },
        {
          "name": "log.file.path",
          "type": "keyword",
          "description": "Path to the log file."
        },
        {
          "name": "ecs.version",
          "external": "ecs"
        },
        {
          "name": "message",
          "external": "ecs"
        },
        {
          "name": "error.message",
          "external": "ecs"
        },
        {
          "name": "tags",
          "external": "ecs"
        },
        {
          "name": "related.hash",
          "external": "ecs"
        },
        {
          "name": "event.ingested",
          "external": "ecs"
        },
        {
          "name": "event.kind",
          "external": "ecs"
        },
        {
          "name": "event.category",
          "external": "ecs"
        },
        {
          "name": "event.type",
          "external": "ecs"
        },
        {
          "name": "event.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.type",
          "external": "ecs"
        },
        {
          "name": "event.created",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.first_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.last_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.size",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.type",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.name",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.extension",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha1",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.mime_type",
          "external": "ecs"
        },
        {
          "name": "threat.software.alias",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.md5",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha256",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.ssdeep",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.sha384",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.hash.tlsh",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.pe.imphash",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.file.elf.telfhash",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.provider",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.port",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.ip",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.confidence",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.description",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.reference",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.domain",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.extension",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.path",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.port",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.scheme",
          "external": "ecs"
        },
        {
          "name": "threat.software.name",
          "external": "ecs"
        },
        {
          "name": "threat.software.reference",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.name",
          "external": "ecs"
        },
        {
          "name": "labels",
          "external": "ecs"
        },
        {
          "name": "event.module",
          "type": "constant_keyword",
          "description": "Event module",
          "value": "ti_abusech"
        },
        {
          "name": "event.dataset",
          "type": "constant_keyword",
          "description": "Event dataset",
          "value": "ti_abusech.threatfox"
        },
        {
          "name": "threat.feed.name",
          "type": "constant_keyword",
          "description": "Display friendly feed name",
          "value": "AbuseCH Threat Fox"
        },
        {
          "name": "threat.feed.dashboard_id",
          "type": "constant_keyword",
          "description": "Dashboard ID used for Kibana CTI UI",
          "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
        },
        {
          "name": "abusech.threatfox",
          "type": "group",
          "description": "All fields related to AbuseCH Threat Fox indicators.",
          "fields": [
            {
              "name": "tags",
              "type": "keyword",
              "description": "A list of tags associated with the queried malware sample.\n"
            },
            {
              "name": "confidence_level",
              "type": "long",
              "description": "Confidence level between 0-100.\n"
            },
            {
              "name": "malware",
              "type": "keyword",
              "description": "The malware associated with the IOC.\n"
            },
            {
              "name": "threat_type",
              "type": "keyword",
              "description": "The type of threat.\n"
            },
            {
              "name": "threat_type_desc",
              "type": "keyword",
              "description": "The threat descsription."
            },
            {
              "name": "deleted_at",
              "type": "date",
              "description": "The indicator expiration timestamp.\n"
            },
            {
              "name": "ioc_expiration_duration",
              "type": "keyword",
              "description": "The configured expiration duration.\n"
            }
          ]
        },
        {
          "name": "labels.is_ioc_transform_source",
          "type": "constant_keyword",
          "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
          "value": "false"
        }
      ]
    },
    "latest_url": {
      "transform": {
        "source": {
          "index": [
            "logs-ti_abusech.url-*"
          ],
          "query": {
            "bool": {
              "must_not": {
                "exists": {
                  "field": "error.message"
                }
              }
            }
          }
        },
        "dest": {
          "index": "logs-ti_abusech_latest.dest_url-3",
          "aliases": [
            {
              "alias": "logs-ti_abusech_latest.url",
              "move_on_creation": true
            }
          ]
        },
        "latest": {
          "sort": "@timestamp",
          "unique_key": [
            "event.dataset",
            "threat.indicator.name"
          ]
        },
        "description": "Latest Abuse CH URL data.",
        "frequency": "30s",
        "_meta": {
          "fleet_transform_version": "0.3.0",
          "managed": true
        },
        "retention_policy": {
          "time": {
            "field": "abusech.url.deleted_at",
            "max_age": "1m"
          }
        },
        "sync": {
          "time": {
            "field": "event.ingested",
            "delay": "120s"
          }
        }
      },
      "manifest": {
        "destination_index_template": {
          "mappings": {},
          "settings": {
            "index": {
              "sort": {
                "field": [
                  "@timestamp"
                ],
                "order": [
                  "desc"
                ]
              }
            }
          }
        },
        "start": true
      },
      "fields": [
        {
          "name": "cloud",
          "type": "group",
          "description": "Fields related to the cloud or infrastructure the events are coming from.",
          "fields": [
            {
              "name": "account.id",
              "type": "keyword",
              "description": "The cloud account or organization id used to identify different entities in a multi-tenant environment.\nExamples: AWS account id, Google Cloud ORG Id, or other unique identifier.",
              "example": 666777888999,
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "availability_zone",
              "type": "keyword",
              "description": "Availability zone in which this host is running.",
              "example": "us-east-1c",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.id",
              "type": "keyword",
              "description": "Instance ID of the host machine.",
              "example": "i-1234567890abcdef0",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "instance.name",
              "type": "keyword",
              "description": "Instance name of the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "machine.type",
              "type": "keyword",
              "description": "Machine type of the host machine.",
              "example": "t2.medium",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "provider",
              "type": "keyword",
              "description": "Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.",
              "example": "aws",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "region",
              "type": "keyword",
              "description": "Region in which this host is running.",
              "example": "us-east-1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "project.id",
              "type": "keyword",
              "description": "Name of the project in Google Cloud."
            },
            {
              "name": "image.id",
              "type": "keyword",
              "description": "Image ID for the cloud instance."
            }
          ],
          "_additional_attributes": {
            "footnote": "Examples: If Metricbeat is running on an EC2 host and fetches data from its host, the cloud info contains the data about this machine. If Metricbeat runs on a remote machine outside the cloud and fetches data from a service running in the cloud, the field contains cloud data from the machine the service is running on.",
            "group": 2,
            "title": "Cloud"
          }
        },
        {
          "name": "container",
          "type": "group",
          "description": "Container fields are used for meta information about the specific container that is the source of information.\nThese fields help correlate data based containers from any runtime.",
          "fields": [
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique container id.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "image.name",
              "type": "keyword",
              "description": "Name of the image the container was built on.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "labels",
              "type": "object",
              "description": "Image labels.",
              "object_type": "keyword",
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Container name.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Container"
          }
        },
        {
          "name": "host",
          "type": "group",
          "description": "A host is defined as a general computing instance.\nECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.",
          "fields": [
            {
              "name": "architecture",
              "type": "keyword",
              "description": "Operating system architecture.",
              "example": "x86_64",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "domain",
              "type": "keyword",
              "description": "Name of the domain of which the host is a member.\nFor example, on Windows this could be the host's Active Directory domain or NetBIOS domain name. For Linux this could be the domain of the host's LDAP provider.",
              "example": "CONTOSO",
              "ignore_above": 1024,
              "_additional_attributes": {
                "default_field": false,
                "level": "extended"
              }
            },
            {
              "name": "hostname",
              "type": "keyword",
              "description": "Hostname of the host.\nIt normally contains what the `hostname` command returns on the host machine.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "id",
              "type": "keyword",
              "description": "Unique host id.\nAs hostname is not always unique, use values that are meaningful in your environment.\nExample: The current usage of `beat.name`.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "ip",
              "type": "ip",
              "description": "Host ip addresses.",
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "mac",
              "type": "keyword",
              "description": "Host mac addresses.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "name",
              "type": "keyword",
              "description": "Name of the host.\nIt can contain what `hostname` returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "os.family",
              "type": "keyword",
              "description": "OS family (such as redhat, debian, freebsd, windows).",
              "example": "debian",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.kernel",
              "type": "keyword",
              "description": "Operating system kernel version as a raw string.",
              "example": "4.4.0-112-generic",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.name",
              "type": "keyword",
              "description": "Operating system name, without the version.",
              "example": "Mac OS X",
              "multi_fields": [
                {
                  "name": "text",
                  "type": "text",
                  "_additional_attributes": {
                    "default_field": false,
                    "norms": false
                  }
                }
              ],
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.platform",
              "type": "keyword",
              "description": "Operating system platform (such centos, ubuntu, windows).",
              "example": "darwin",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "os.version",
              "type": "keyword",
              "description": "Operating system version as a raw string.",
              "example": "10.14.1",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "extended"
              }
            },
            {
              "name": "type",
              "type": "keyword",
              "description": "Type of host.\nFor Cloud providers this can be the machine type like `t2.medium`. If vm, this could be the container, for example, or other information meaningful in your environment.",
              "ignore_above": 1024,
              "_additional_attributes": {
                "level": "core"
              }
            },
            {
              "name": "containerized",
              "type": "boolean",
              "description": "If the host is a container.\n"
            },
            {
              "name": "os.build",
              "type": "keyword",
              "description": "OS build information.\n",
              "example": "18D109"
            },
            {
              "name": "os.codename",
              "type": "keyword",
              "description": "OS codename, if any.\n",
              "example": "stretch"
            }
          ],
          "_additional_attributes": {
            "group": 2,
            "title": "Host"
          }
        },
        {
          "name": "data_stream.type",
          "type": "constant_keyword",
          "description": "Data stream type."
        },
        {
          "name": "data_stream.dataset",
          "type": "constant_keyword",
          "description": "Data stream dataset name."
        },
        {
          "name": "data_stream.namespace",
          "type": "constant_keyword",
          "description": "Data stream namespace."
        },
        {
          "name": "@timestamp",
          "type": "date",
          "description": "Event timestamp."
        },
        {
          "name": "input.type",
          "type": "keyword",
          "description": "Type of Filebeat input."
        },
        {
          "name": "log.flags",
          "type": "keyword",
          "description": "Flags for the log file."
        },
        {
          "name": "log.offset",
          "type": "long",
          "description": "Offset of the entry in the log file."
        },
        {
          "name": "log.file.path",
          "type": "keyword",
          "description": "Path to the log file."
        },
        {
          "name": "ecs.version",
          "external": "ecs"
        },
        {
          "name": "message",
          "external": "ecs"
        },
        {
          "name": "error.message",
          "external": "ecs"
        },
        {
          "name": "tags",
          "external": "ecs"
        },
        {
          "name": "event.ingested",
          "external": "ecs"
        },
        {
          "name": "event.kind",
          "external": "ecs"
        },
        {
          "name": "event.category",
          "external": "ecs"
        },
        {
          "name": "event.type",
          "external": "ecs"
        },
        {
          "name": "event.created",
          "external": "ecs"
        },
        {
          "name": "event.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.type",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.reference",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.first_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.last_seen",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.domain",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.full",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.fragment",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.extension",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.original",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.path",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.port",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.scheme",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.url.query",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.ip",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.provider",
          "external": "ecs"
        },
        {
          "name": "threat.indicator.name",
          "external": "ecs"
        },
        {
          "name": "labels",
          "external": "ecs"
        },
        {
          "name": "event.module",
          "type": "constant_keyword",
          "description": "Event module",
          "value": "ti_abusech"
        },
        {
          "name": "event.dataset",
          "type": "constant_keyword",
          "description": "Event dataset",
          "value": "ti_abusech.url"
        },
        {
          "name": "threat.feed.name",
          "type": "constant_keyword",
          "description": "Display friendly feed name",
          "value": "AbuseCH URL"
        },
        {
          "name": "threat.feed.dashboard_id",
          "type": "constant_keyword",
          "description": "Dashboard ID used for Kibana CTI UI",
          "value": "ti_abusech-c0d8d1f0-3b20-11ec-ae50-2fdf1e96c6a6"
        },
        {
          "name": "abusech.url",
          "type": "group",
          "description": "All fields related to AbuseCH URL indicators.",
          "fields": [
            {
              "name": "id",
              "type": "keyword",
              "description": "The ID of the indicator.\n"
            },
            {
              "name": "last_online",
              "type": "date",
              "description": "Last timestamp when the URL has been serving malware.\n"
            },
            {
              "name": "deleted_at",
              "type": "date",
              "description": "The timestamp when the indicator is (will be) deleted.\n"
            },
            {
              "name": "urlhaus_reference",
              "type": "keyword",
              "description": "Link to URLhaus entry.\n"
            },
            {
              "name": "url_status",
              "type": "keyword",
              "description": "The current status of the URL. Possible values are: online, offline and unknown.\n"
            },
            {
              "name": "threat",
              "type": "keyword",
              "description": "The threat corresponding to this malware URL.\n"
            },
            {
              "name": "reporter",
              "type": "keyword",
              "description": "The Twitter handle of the reporter that has reported this malware URL (or anonymous).\n"
            },
            {
              "name": "larted",
              "type": "boolean",
              "description": "Indicates whether the malware URL has been reported to the hosting provider (true or false).\n"
            },
            {
              "name": "tags",
              "type": "keyword",
              "description": "A list of tags associated with the queried malware URL.\n"
            },
            {
              "name": "blacklists.spamhaus_dbl",
              "type": "keyword",
              "description": "If the indicator is listed on the spamhaus blacklist.\n"
            },
            {
              "name": "blacklists.surbl",
              "type": "keyword",
              "description": "If the indicator is listed on the surbl blacklist.\n"
            }
          ]
        },
        {
          "name": "labels.interval",
          "type": "keyword",
          "description": "User-configured value for `Interval` setting. This is used in calculation of indicator expiration time."
        },
        {
          "name": "labels.is_ioc_transform_source",
          "type": "constant_keyword",
          "description": "Indicates whether an IOC is in the raw source data stream, or the in latest destination index.",
          "value": "false"
        }
      ]
    }
  },
  "changelog": {
    "releases": [
      {
        "version": "3.0.0",
        "changes": [
          {
            "description": "Auth Key (API Key) is now required for all AbuseCH API requests. Requests without authentication will be denied.\nSee the official announcement: https://abuse.ch/blog/community-first/\n",
            "type": "breaking-change",
            "link": "https://github.com/elastic/integrations/pull/14335"
          }
        ]
      },
      {
        "version": "2.10.1",
        "changes": [
          {
            "description": "Add temporary processor to remove the fields added by the Agentless policy.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/14172"
          }
        ]
      },
      {
        "version": "2.10.0",
        "changes": [
          {
            "description": "Increase memory for agentless deployment.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/13760"
          }
        ]
      },
      {
        "version": "2.9.2",
        "changes": [
          {
            "description": "Fix default request trace enabled behavior.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/13712"
          }
        ]
      },
      {
        "version": "2.9.1",
        "changes": [
          {
            "description": "Properly handle CEL errors.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/13708"
          }
        ]
      },
      {
        "version": "2.9.0",
        "changes": [
          {
            "description": "Enable request trace log removal.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/13452"
          }
        ]
      },
      {
        "version": "2.8.0",
        "changes": [
          {
            "description": "Add support for 'Auth-Key' in request header for all data streams.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/13261"
          }
        ]
      },
      {
        "version": "2.7.0",
        "changes": [
          {
            "description": "Enable Agentless deployment.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/13173"
          }
        ]
      },
      {
        "version": "2.6.1",
        "changes": [
          {
            "description": "Add support for 'Auth-Key' in request header for all data streams.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/13317"
          }
        ]
      },
      {
        "version": "2.6.0",
        "changes": [
          {
            "description": "Update Kibana constraint to support 9.0.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/12919"
          }
        ]
      },
      {
        "version": "2.5.1",
        "changes": [
          {
            "description": "Updated SSL description to be uniform and to include links to documentation.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/12697"
          }
        ]
      },
      {
        "version": "2.5.0",
        "changes": [
          {
            "description": "Do not remove `event.original` in main ingest pipeline.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/12076"
          }
        ]
      },
      {
        "version": "2.4.0",
        "changes": [
          {
            "description": "Add \"preserve_original_event\" tag to documents with `event.kind` set to \"pipeline_error\".",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/12046"
          }
        ]
      },
      {
        "version": "2.3.5",
        "changes": [
          {
            "description": "Use triple-brace Mustache templating when referencing variables in ingest pipelines.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/11314"
          }
        ]
      },
      {
        "version": "2.3.4",
        "changes": [
          {
            "description": "Use triple-brace Mustache templating when referencing variables in ingest pipelines.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/11284"
          }
        ]
      },
      {
        "version": "2.3.3",
        "changes": [
          {
            "description": "Fix labels.is_ioc_transform_source values",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/11231"
          }
        ]
      },
      {
        "version": "2.3.2",
        "changes": [
          {
            "description": "Add missing fields in transform",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/11008"
          }
        ]
      },
      {
        "version": "2.3.1",
        "changes": [
          {
            "description": "Fix ECS date mapping on threat fields.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/10637"
          }
        ]
      },
      {
        "version": "2.3.0",
        "changes": [
          {
            "description": "Improve error reporting for API request failures.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/10346"
          }
        ]
      },
      {
        "version": "2.2.0",
        "changes": [
          {
            "description": "Update the kibana constraint to ^8.13.0. Modified the field definitions to remove ECS fields made redundant by the ecs@mappings component template.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/10135"
          }
        ]
      },
      {
        "version": "2.1.0",
        "changes": [
          {
            "description": "Improve error handling and reporting in malwarebazaar data stream.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/10156"
          }
        ]
      },
      {
        "version": "2.0.1",
        "changes": [
          {
            "description": "Adjust field mappings for transform destination index.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/10049"
          }
        ]
      },
      {
        "version": "2.0.0",
        "changes": [
          {
            "description": "Support IoC expiration",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7793"
          }
        ]
      },
      {
        "version": "1.25.0",
        "changes": [
          {
            "description": "Update manifest format version to v3.0.3.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/9404"
          }
        ]
      },
      {
        "version": "1.24.1",
        "changes": [
          {
            "description": "Changed owners",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/8943"
          }
        ]
      },
      {
        "version": "1.24.0",
        "changes": [
          {
            "description": "Limit request tracer log count to five.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/8489"
          }
        ]
      },
      {
        "version": "1.23.0",
        "changes": [
          {
            "description": "ECS version updated to 8.11.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/8436"
          }
        ]
      },
      {
        "version": "1.22.0",
        "changes": [
          {
            "description": "Improve 'event.original' check to avoid errors if set.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/8269"
          }
        ]
      },
      {
        "version": "1.21.0",
        "changes": [
          {
            "description": "ECS version updated to 8.10.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7920"
          }
        ]
      },
      {
        "version": "1.20.0",
        "changes": [
          {
            "description": "The format_version in the package manifest changed from 2.11.0 to 3.0.0. Removed dotted YAML keys from package manifest. Added 'owner.type: elastic' to package manifest.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7883"
          }
        ]
      },
      {
        "version": "1.19.0",
        "changes": [
          {
            "description": "Add tags.yml file so that integration's dashboards and saved searches are tagged with \"Security Solution\" and displayed in the Security Solution UI.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7789"
          }
        ]
      },
      {
        "version": "1.18.0",
        "changes": [
          {
            "description": "Update package-spec to 2.9.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7315"
          }
        ]
      },
      {
        "version": "1.17.0",
        "changes": [
          {
            "description": "Update package to ECS 8.9.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/7111"
          }
        ]
      },
      {
        "version": "1.16.0",
        "changes": [
          {
            "description": "Document duration units.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6992"
          }
        ]
      },
      {
        "version": "1.15.2",
        "changes": [
          {
            "description": "Change ThreatFox initial interval to integer and note valid values 1-7",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/7143"
          }
        ]
      },
      {
        "version": "1.15.1",
        "changes": [
          {
            "description": "Remove fields with empty string values",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/7103"
          }
        ]
      },
      {
        "version": "1.15.0",
        "changes": [
          {
            "description": "Convert visualizations to lens.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6924"
          }
        ]
      },
      {
        "version": "1.14.0",
        "changes": [
          {
            "description": "Document valid duration units.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6706"
          }
        ]
      },
      {
        "version": "1.13.0",
        "changes": [
          {
            "description": "Ensure event.kind is correctly set for pipeline errors.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6629"
          }
        ]
      },
      {
        "version": "1.12.0",
        "changes": [
          {
            "description": "Update package to ECS 8.8.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6328"
          }
        ]
      },
      {
        "version": "1.11.0",
        "changes": [
          {
            "description": "Add a new flag to enable request tracing",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/6115"
          }
        ]
      },
      {
        "version": "1.10.0",
        "changes": [
          {
            "description": "Update package to ECS 8.7.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/5765"
          }
        ]
      },
      {
        "version": "1.9.0",
        "changes": [
          {
            "description": "Update package to ECS 8.6.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/4576"
          }
        ]
      },
      {
        "version": "1.8.0",
        "changes": [
          {
            "description": "Update package to ECS 8.5.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/4285"
          }
        ]
      },
      {
        "version": "1.7.1",
        "changes": [
          {
            "description": "Change abusech.malwarebazaar.code_sign to Nested field",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/4102"
          }
        ]
      },
      {
        "version": "1.7.0",
        "changes": [
          {
            "description": "Add Threat Fox datastream",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3962"
          }
        ]
      },
      {
        "version": "1.6.0",
        "changes": [
          {
            "description": "Update package to ECS 8.4.0",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3871"
          }
        ]
      },
      {
        "version": "1.5.1",
        "changes": [
          {
            "description": "Fix proxy URL documentation rendering.",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/3881"
          }
        ]
      },
      {
        "version": "1.5.0",
        "changes": [
          {
            "description": "Update categories to include `threat_intel`.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3689"
          }
        ]
      },
      {
        "version": "1.4.0",
        "changes": [
          {
            "description": "Update package to ECS 8.3.0.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3353"
          }
        ]
      },
      {
        "version": "1.3.2",
        "changes": [
          {
            "description": "Added link to AbuseCH documentation in readme",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3166"
          }
        ]
      },
      {
        "version": "1.3.1",
        "changes": [
          {
            "description": "Update package descriptions",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3398"
          }
        ]
      },
      {
        "version": "1.3.0",
        "changes": [
          {
            "description": "Update to ECS 8.2",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2781"
          }
        ]
      },
      {
        "version": "1.2.3",
        "changes": [
          {
            "description": "Add mapping for event.created",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/3042"
          }
        ]
      },
      {
        "version": "1.2.2",
        "changes": [
          {
            "description": "Add documentation for multi-fields",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2916"
          }
        ]
      },
      {
        "version": "1.2.1",
        "changes": [
          {
            "description": "Fix field mapping conflicts in `threat.indicator.file.x509.not_before/not_after`",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/2893"
          }
        ]
      },
      {
        "version": "1.2.0",
        "changes": [
          {
            "description": "Update to ECS 8.0",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2445"
          }
        ]
      },
      {
        "version": "1.1.5",
        "changes": [
          {
            "description": "Removes extra tag from dashboards",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/2544"
          }
        ]
      },
      {
        "version": "1.1.4",
        "changes": [
          {
            "description": "Regenerate test files using the new GeoIP database",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/2339"
          }
        ]
      },
      {
        "version": "1.1.3",
        "changes": [
          {
            "description": "Change test public IPs to the supported subset",
            "type": "bugfix",
            "link": "https://github.com/elastic/integrations/pull/2327"
          }
        ]
      },
      {
        "version": "1.1.2",
        "changes": [
          {
            "description": "Fixing typo in base-fields.yml",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2331"
          }
        ]
      },
      {
        "version": "1.1.1",
        "changes": [
          {
            "description": "Update ECS fields for threat.feed.name",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2293"
          }
        ]
      },
      {
        "version": "1.1.0",
        "changes": [
          {
            "description": "Adding dashboards and adding minor tweaks to pipeline",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2072"
          }
        ]
      },
      {
        "version": "1.0.4",
        "changes": [
          {
            "description": "Bump minimum version in manifest",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2072"
          }
        ]
      },
      {
        "version": "1.0.3",
        "changes": [
          {
            "description": "Bump minimum version",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/2063"
          }
        ]
      },
      {
        "version": "1.0.2",
        "changes": [
          {
            "description": "Update title and description.",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/1997"
          }
        ]
      },
      {
        "version": "1.0.1",
        "changes": [
          {
            "description": "Fix invisible package icon",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/1939"
          }
        ]
      },
      {
        "version": "1.0.0",
        "changes": [
          {
            "description": "Initial Release",
            "type": "enhancement",
            "link": "https://github.com/elastic/integrations/pull/1866"
          }
        ]
      }
    ]
  }
}
